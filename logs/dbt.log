==================== 2025-11-15 21:11:00.858089 | 019a895b-69f0-7f51-8127-d575f79d1220 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:11:01.067400 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:11:01.067620 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:11:01.067627 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:11:03.006235 [error]: dbt1014: [Snowflake] 261004 (08004): failed to auth for unknown reason. HTTP: 404, URL: https://your-account-id.snowflakecomputing.com:443/session/v1/login-request?databaseName=jaffle_shop&requestId=1e3495d4-0c67-4e7c-662c-9d5d310dc256&request_guid=17072ef3-ca26-48ec-7539-d6be5334d9cf&roleName=your_role&schemaName=dbt_dev&warehouse=your_warehouse
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:12:07.570936 | 019a895c-6e91-7cb0-ab53-2af8c158b742 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:12:07.572452 [error]: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `databricks`, `salesforce`
21:12:07.862579 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 1 error for target 'duckdb' [291ms]
==================== 2025-11-15 21:12:24.733931 | 019a895c-b19c-7612-966a-ad7f63cf04e8 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:12:24.736806 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'DBT_SNOWFLAKE_ACCOUNT' not found
(in :1:2)
  --> :1:2
21:12:24.808820 [info ]: 
==================== Execution Summary =====================
Finished 'compile' with 1 error [74ms]
==================== 2025-11-15 21:13:55.269666 | 019a895e-133c-7fc0-94e8-81c650f56ede ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:13:55.290591 [error]: dbt1501: Failed to eval the compiled Jinja expression invalid operation: 'env_var': environment variable 'DBT_SNOWFLAKE_ACCOUNT' not found
(in :1:2)
  --> :1:2
21:13:55.571237 [info ]: 
==================== Execution Summary =====================
Finished 'compile' with 1 error [301ms]
==================== 2025-11-15 21:15:24.910512 | 019a895f-716d-76a3-9515-ec185554590a ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:15:25.108862 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:15:25.108892 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:15:25.108898 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:15:25.154843 [error]: dbt1005: Configuration Error: Private key file not found: '~/.ssh/snowflake_rsa_key.p8'
New version available 2.0.0-preview.67 (run `dbt system update`)
21:15:25.635157 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [724ms]
==================== 2025-11-15 21:16:02.575703 | 019a8960-048e-7a63-9b36-ea868e94aebe ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:16:02.743953 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:16:02.743981 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:16:02.743986 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:16:02.815589 [error]: dbt1014: adbc.snowflake.sql.client_option.jwt_private_key_pkcs8_password is not configured
New version available 2.0.0-preview.67 (run `dbt system update`)
21:16:02.936758 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [361ms]
==================== 2025-11-15 21:16:14.658917 | 019a8960-33c1-7c41-893e-dc612f0338ba ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:16:14.826719 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:16:14.826752 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:16:14.826758 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:16:14.894465 [error]: dbt1014: [Snowflake] failed parsing PKCS8 private key: asn1: structure error: tags don't match (2 vs {class:0 tag:16 length:64 isCompound:true}) {optional:false explicit:false application:false private:false defaultValue:<nil> tag:<nil> stringType:0 timeType:0 set:false omitEmpty:false} int @2
New version available 2.0.0-preview.67 (run `dbt system update`)
21:16:15.005275 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [346ms]
==================== 2025-11-15 21:18:03.598047 | 019a8961-dd45-7f43-8899-55ce9bab6d79 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:18:03.813188 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:18:03.813400 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:18:03.813406 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:18:04.482929 [error]: dbt1014: [Snowflake] 390144 (08004): JWT token is invalid. [fc58c6dd-d82c-4334-abb3-da746051b87c]
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:18:42.803350 | 019a8962-7672-7d42-af6d-fb27a57ccb15 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:18:42.963090 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:18:42.963120 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:18:42.963125 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:18:43.489414 [error]: dbt1014: [Snowflake] 390144 (08004): JWT token is invalid. [ffa8db2b-bc19-45ca-8490-8e58da9f8bbb]
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:21:13.851665 | 019a8964-c472-7e91-85cd-6abfe30cc313 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:21:14.065945 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:21:14.066181 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:21:14.066187 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:21:14.935358 [error]: dbt1014: [Snowflake] 390144 (08004): JWT token is invalid. [48db042d-ffaa-4eb1-b1d1-a3636d132742]
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:22:49.730708 | 019a8966-3b01-79a1-bd94-e0e72c1ccdca ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:22:49.892604 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:22:49.892629 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:22:49.892634 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:22:54.127855 [error]: dbt1014: [Snowflake] 390191 (08004): The user you were trying to authenticate as differs from the user currently logged in at the IDP.
New version available 2.0.0-preview.67 (run `dbt system update`)
21:22:54.151795 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [4.4s]
==================== 2025-11-15 21:23:12.466774 | 019a8966-93d1-7d82-bcb5-c46de6df6d41 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:23:12.626737 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:23:12.626767 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:23:12.626773 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:23:16.796330 [error]: dbt1014: [Snowflake] 390191 (08004): The user you were trying to authenticate as differs from the user currently logged in at the IDP.
New version available 2.0.0-preview.67 (run `dbt system update`)
21:23:16.833393 [info ]: 
==================== Execution Summary =====================
Finished 'compile' with 3 warnings and 1 error for target 'dev' [4.4s]
==================== 2025-11-15 21:24:34.264527 | 019a8967-d34f-7310-ae5e-3dadbb2f0375 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
21:24:34.470297 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:24:34.470506 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:24:34.470513 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:24:38.319875 [error]: dbt1014: [Snowflake] 390191 (08004): The user you were trying to authenticate as differs from the user currently logged in at the IDP.
New version available 2.0.0-preview.67 (run `dbt system update`)
21:24:38.350699 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [4.1s]
==================== 2025-11-15 21:25:05.707611 | 019a8968-4e2a-7dd1-ae1b-8ed589d8ac56 ====================
dbt-fusion 2.0.0-preview.63
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.63
 Debugging platform: macos aarch64 (unix)
 Debugging adapter type: snowflake (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "client_session_keep_alive": false,
  "query_tag": "dbt-fivetran-analytics",
  "authenticator": "externalbrowser",
  "account": "a3209653506471-sales_eng_demo",
  "user": "jason.chletsos",
  "database": "JASON_CHLETSOS",
  "warehouse": "COMPUTE_WH",
  "schema": "fivetran_analytics",
  "role": "ACCOUNTADMIN"
21:25:08.948965 [error]: dbt1011: [Snowflake] 390191 (08004): The user you were trying to authenticate as differs from the user currently logged in at the IDP.
New version available 2.0.0-preview.67 (run `dbt system update`)
21:25:09.130242 [info ]: 
==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [3.4s]
==================== 2025-11-15 21:25:31.032877 | 019a8968-b117-7922-94b7-53e21f6fdb61 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:25:31.195680 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:25:31.195705 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:25:31.195710 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:25:31.480258 [error]: dbt1014: [Snowflake] 390186 (08004): Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:25:44.863807 | 019a8968-e71e-7e13-b0ed-97f9fc87dd67 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:25:45.024788 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:25:45.024818 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:25:45.024823 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:25:45.284768 [error]: dbt1014: [Snowflake] 390189 (08004): Role 'ANALYST' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
New version available 2.0.0-preview.67 (run `dbt system update`)
==================== 2025-11-15 21:27:03.431717 | 019a896a-1a06-73f3-bb82-5984e46d3bda ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:27:03.630156 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:27:03.630183 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:27:03.630190 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:27:04.526608 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."CONNECTION"
21:27:04.841776 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."CONNECTOR_TYPE"
21:27:05.639806 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."DESTINATION"
21:27:05.949987 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."INCREMENTAL_MAR"
21:27:06.071559 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."LOG"
21:27:06.347251 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."TRANSFORMATION_RUNS"
21:27:06.764622 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."FIVETRAN_LOG"."USER"
21:27:07.988027 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.connection'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__connection': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988149 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.connector_type'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__connector_type': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988199 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.destination'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__destination': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988245 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.incremental_mar'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__incremental_mar': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988291 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.log'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__log': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988331 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.transformation_runs'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__transformation_runs': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:07.988366 [warn ]: dbt1014: Failed to download source schema for 'source.fivetran_analytics.fivetran_log.user'. Setting 'static_analysis' to off. Skipping analysis for 'model.fivetran_analytics.stg_fivetran_log__user': [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
21:27:08.591013 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:08.771547 [debug]: Query executed on node unknown:
create schema if not exists JASON_CHLETSOS.fivetran_analytics
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:08.967647 [debug]: Query executed on node unknown:
create schema if not exists JASON_CHLETSOS.fivetran_analytics_fivetran_analytics
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:09.217194 [debug]: Query executed on node unknown:
create schema if not exists JASON_CHLETSOS.fivetran_analytics_int_fivetran_log
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:09.370382 [debug]: Query executed on node unknown:
create schema if not exists JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:09.783617 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__log:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:09.786354 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__log"
21:27:09.957682 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__log:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.log
),

renamed as (
    select
        id as log_id,
        time_stamp as logged_at,
        connection_id,
        event as event_type,
        message_event as message_type,
        message_data as message_content,
        sync_id,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__log"} */
21:27:10.134753 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__destination:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:10.135692 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__destination"
21:27:10.227580 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__destination:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.destination
),

renamed as (
    select
        id as destination_id,
        name as destination_name,
        account_id,
        created_at,
        region,
        is_active,
        deployment_type,
        destination_type,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__destination"} */
21:27:10.394747 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connector_type:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:10.395341 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__connector_type"
21:27:10.485923 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connector_type:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.connector_type
),

renamed as (
    select
        id as connector_type_id,
        official_connector_name as connector_name,
        type as connector_type,
        availability as availability_status,
        created_at,
        public_beta_at,
        release_at as released_at,
        deleted as is_deleted,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__connector_type"} */
21:27:10.726914 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__transformation_runs:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:10.728225 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__transformation_runs"
21:27:10.880652 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__transformation_runs:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.transformation_runs
),

renamed as (
    select
        destination_id,
        job_id,
        measured_date,
        project_type,
        case 
            when free_type = 'free' then true
            else false
        end as is_free,
        job_name,
        updated_at,
        model_runs,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__transformation_runs"} */
    Failed [  1.58s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log (view)
21:27:10.962422 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__log: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__log.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__log.sql:1:14
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history (table)
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls (view)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage (table)
21:27:11.072069 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__user:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:11.073058 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__user"
21:27:11.159583 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__user:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.user
),

renamed as (
    select
        id as user_id,
        email,
        given_name as first_name,
        family_name as last_name,
        created_at,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__user"} */
    Failed [  1.85s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination (view)
21:27:11.232866 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__destination: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__destination.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__destination.sql:1:14
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details (view)
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends (table)
21:27:11.337046 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__incremental_mar:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:11.337658 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__incremental_mar"
21:27:11.421247 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__incremental_mar:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.incremental_mar
),

renamed as (
    select
        connection_name,
        destination_id,
        measured_date,
        schema_name,
        sync_type,
        table_name,
        case 
            when free_type = 'free' then true
            else false
        end as is_free,
        updated_at,
        incremental_rows,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__incremental_mar"} */
    Failed [  2.11s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type (view)
21:27:11.491245 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__connector_type: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__connector_type.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__connector_type.sql:1:14
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details (view)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends (table)
21:27:11.555819 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connection:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:27:11.556815 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__connection"
21:27:11.849993 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connection:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
  
   as (
    with source as (
    select * from JASON_CHLETSOS.fivetran_log.connection
),

renamed as (
    select
        connection_id,
        connecting_user_id,
        connector_type_id,
        connection_name,
        signed_up as created_at,
        paused as is_paused,
        sync_frequency as sync_frequency_minutes,
        deployment_type,
        _fivetran_deleted as is_deleted,
        destination_id,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__connection"} */
    Failed [  2.50s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs (view)
21:27:11.884907 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__transformation_runs: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__transformation_runs.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__transformation_runs.sql:1:14
21:27:11.957226 [debug]: Query executed on node model.fivetran_analytics.my_first_dbt_model:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS" LIMIT 10000
21:27:11.958769 [debug]: Writing runtime sql for node "model.fivetran_analytics.my_first_dbt_model"
    Failed [  2.78s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user (view)
21:27:12.164946 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__user: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__user.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__user.sql:1:14
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
21:27:12.213507 [debug]: Query executed on node model.fivetran_analytics.sample_model:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS" LIMIT 10000
21:27:12.214411 [debug]: Writing runtime sql for node "model.fivetran_analytics.sample_model"
    Failed [  3.04s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar (view)
21:27:12.428373 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__incremental_mar: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__incremental_mar.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__incremental_mar.sql:1:14
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows (view)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
21:27:12.740288 [debug]: Query executed on node model.fivetran_analytics.my_first_dbt_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.my_first_dbt_model
    
    
    
    as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.my_first_dbt_model"} */
 Succeeded [  3.30s] model fivetran_analytics.my_first_dbt_model (table)
21:27:12.742443 [debug]: Writing runtime sql for node "model.fivetran_analytics.my_second_dbt_model"
    Failed [  3.47s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection (view)
21:27:12.855451 [error]: dbt1014: Error executing materialization macro 'dbt_snowflake.materialization_view_snowflake' for model model.fivetran_analytics.stg_fivetran_log__connection: [Snowflake] 002003 (02000): SQL compilation error:
Schema 'JASON_CHLETSOS.FIVETRAN_LOG' does not exist or not authorized.
(in compiled/models/staging/stg_fivetran_log__connection.sql:1:14)
(in dbt_internal_packages/dbt-snowflake/macros/materializations/view.sql:5:24)
(in dbt_internal_packages/dbt-snowflake/macros/relations/view/create.sql:62:11)
(in dbt_internal_packages/dbt-adapters/macros/etc/statement.sql:14:35)
  --> compiled/models/staging/stg_fivetran_log__connection.sql:1:14
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details (view)
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls (view)
   Skipped [-------] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors (table)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends (table)
21:27:13.038036 [debug]: Query executed on node model.fivetran_analytics.sample_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.sample_model
    
    
    
    as (-- This is a sample model that doesn't require a connection
-- It will help us test if dbt compilation works

select 1 as id, 'test' as name
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.sample_model"} */
 Succeeded [  3.60s] model fivetran_analytics.sample_model (table)
21:27:13.955034 [debug]: Query executed on node model.fivetran_analytics.my_second_dbt_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.my_second_dbt_model
    
    
    
    as (
-- Use the `ref` function to select from other models

select *
from JASON_CHLETSOS.fivetran_analytics.my_first_dbt_model
where id = 1
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.my_second_dbt_model"} */
 Succeeded [  1.21s] model fivetran_analytics.my_second_dbt_model (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:27:14.011891 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 10 warnings and 7 errors for target 'dev' [10.6s]
Processed: 25 models
Summary: 25 total | 3 success | 7 error | 15 skipped
==================== 2025-11-15 21:27:34.828185 | 019a896a-94ab-77a2-af67-fc0719170318 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:27:34.987268 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:27:34.987298 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:27:34.987303 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:27:35.774409 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:27:36.339402 [debug]: Query executed on node model.fivetran_analytics.sample_model:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS" LIMIT 10000
21:27:36.340356 [debug]: Writing runtime sql for node "model.fivetran_analytics.sample_model"
21:27:37.067602 [debug]: Query executed on node model.fivetran_analytics.sample_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.sample_model
    
    
    
    as (-- This is a sample model that doesn't require a connection
-- It will help us test if dbt compilation works

select 1 as id, 'test' as name
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.sample_model"} */
 Succeeded [  1.27s] model fivetran_analytics.sample_model (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:27:37.111957 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [2.3s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 21:29:55.241915 | 019a896c-b928-7501-af55-26a5444d7d95 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:29:55.399486 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:29:55.399514 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:29:55.399520 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:29:55.847389 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."CONNECTION"
21:29:55.955665 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."CONNECTOR_TYPE"
21:29:56.050552 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."DESTINATION"
21:29:56.100057 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."INCREMENTAL_MAR"
21:29:56.146260 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."LOG"
21:29:56.192256 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."TRANSFORMATION_RUNS"
21:29:56.270483 [debug]: Query executed on node unknown:
describe table "JASON_CHLETSOS"."JASON_CHLETSOS_FIVETRAN_LOG"."USER"
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connection (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connector_type (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.incremental_mar (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.log (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.transformation_runs (schema)
 Downloading JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.user (schema)
21:29:57.097167 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:29:57.460316 [debug]: Query executed on node model.fivetran_analytics.my_first_dbt_model:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS" LIMIT 10000
21:29:57.461304 [debug]: Writing runtime sql for node "model.fivetran_analytics.my_first_dbt_model"
21:29:57.743197 [debug]: Query executed on node model.fivetran_analytics.sample_model:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS" LIMIT 10000
21:29:57.744715 [debug]: Writing runtime sql for node "model.fivetran_analytics.sample_model"
21:29:58.060341 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__user:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:58.061801 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__user"
21:29:58.143904 [debug]: Query executed on node model.fivetran_analytics.my_first_dbt_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.my_first_dbt_model
    
    
    
    as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.my_first_dbt_model"} */
 Succeeded [  1.01s] model fivetran_analytics.my_first_dbt_model (table)
21:29:58.147336 [debug]: Writing runtime sql for node "model.fivetran_analytics.my_second_dbt_model"
21:29:58.290932 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__user:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.user
),

renamed as (
    select
        id as user_id,
        email,
        given_name as first_name,
        family_name as last_name,
        created_at,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__user"} */
 Succeeded [  1.15s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user (view)
21:29:58.331414 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__log:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:58.332041 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__log"
21:29:58.420478 [debug]: Query executed on node model.fivetran_analytics.sample_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.sample_model
    
    
    
    as (-- This is a sample model that doesn't require a connection
-- It will help us test if dbt compilation works

select 1 as id, 'test' as name
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.sample_model"} */
 Succeeded [  1.28s] model fivetran_analytics.sample_model (table)
21:29:58.578767 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connector_type:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:58.580214 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__connector_type"
21:29:58.638807 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__log:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.log
),

renamed as (
    select
        id as log_id,
        time_stamp as logged_at,
        connection_id,
        event as event_type,
        message_event as message_type,
        message_data as message_content,
        sync_id,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__log"} */
 Succeeded [  1.50s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log (view)
21:29:58.818090 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connector_type:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connector_type
),

renamed as (
    select
        id as connector_type_id,
        official_connector_name as connector_name,
        type as connector_type,
        availability as availability_status,
        created_at,
        public_beta_at,
        release_at as released_at,
        deleted as is_deleted,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__connector_type"} */
 Succeeded [  1.68s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type (view)
21:29:58.842022 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__destination:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:58.843668 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__destination"
21:29:59.009141 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connection:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:59.010638 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__connection"
21:29:59.050100 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__destination:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination
),

renamed as (
    select
        id as destination_id,
        name as destination_name,
        account_id,
        created_at,
        region,
        is_active,
        deployment_type,
        destination_type,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__destination"} */
 Succeeded [  1.91s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination (view)
21:29:59.286368 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__connection:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connection
),

renamed as (
    select
        connection_id,
        connecting_user_id,
        connector_type_id,
        connection_name,
        signed_up as created_at,
        paused as is_paused,
        sync_frequency as sync_frequency_minutes,
        deployment_type,
        _fivetran_deleted as is_deleted,
        destination_id,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__connection"} */
 Succeeded [  2.15s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection (view)
21:29:59.320115 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__transformation_runs:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:59.321437 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__transformation_runs"
21:29:59.437734 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__connector_details:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
21:29:59.438901 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__connector_details"
21:29:59.462624 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__daily_api_calls:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
21:29:59.463839 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__daily_api_calls"
21:29:59.475944 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
21:29:59.476700 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
21:29:59.568148 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__incremental_mar:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG" LIMIT 10000
21:29:59.568675 [debug]: Writing runtime sql for node "model.fivetran_analytics.stg_fivetran_log__incremental_mar"
21:29:59.643290 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__transformation_runs:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.transformation_runs
),

renamed as (
    select
        destination_id,
        job_id,
        measured_date,
        project_type,
        case 
            when free_type = 'free' then true
            else false
        end as is_free,
        job_name,
        updated_at,
        model_runs,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__transformation_runs"} */
 Succeeded [  2.50s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs (view)
21:29:59.814835 [debug]: Query executed on node model.fivetran_analytics.stg_fivetran_log__incremental_mar:
create or replace   view JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar
  
   as (
    with source as (
    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.incremental_mar
),

renamed as (
    select
        connection_name,
        destination_id,
        measured_date,
        schema_name,
        sync_type,
        table_name,
        case 
            when free_type = 'free' then true
            else false
        end as is_free,
        updated_at,
        incremental_rows,
        _fivetran_synced
    from source
)

select * from renamed
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.stg_fivetran_log__incremental_mar"} */
 Succeeded [  2.67s] model fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar (view)
21:29:59.817189 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__daily_active_rows"
21:29:59.900033 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

-- Extract sync start events
sync_starts as (
    select
        sync_id,
        connection_id,
        logged_at as sync_start_time
    from logs
    where event_type = 'sync_start'
),

-- Extract sync end events
sync_ends as (
    select
        sync_id,
        connection_id,
        logged_at as sync_end_time,
        case 
            when message_type = 'sync_error' then 'error'
            when message_type = 'sync_cancelled' then 'cancelled'
            else 'success'
        end as sync_status,
        case 
            when message_type = 'sync_error' then message_content
            else null
        end as error_message
    from logs
    where event_type = 'sync_end'
),

-- Extract row count information
row_counts as (
    select
        sync_id,
        connection_id,
        try_cast(regexp_substr(message_content, '\\d+') as integer) as rows_synced
    from logs
    where event_type = 'sync_end' 
    and message_type = 'synced_rows'
),

-- Combine all sync information
combined_syncs as (
    select
        ss.sync_id,
        ss.connection_id,
        c.connection_name,
        ss.sync_start_time,
        se.sync_end_time,
        se.sync_status,
        se.error_message,
        datediff(second, ss.sync_start_time, se.sync_end_time) as sync_duration_seconds,
        coalesce(rc.rows_synced, 0) as rows_synced,
        c.destination_id,
        d.destination_name
    from sync_starts ss
    left join sync_ends se on ss.sync_id = se.sync_id
    left join row_counts rc on ss.sync_id = rc.sync_id
    left join connections c on ss.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
    where se.sync_end_time is not null -- Only include completed syncs
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  0.61s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
21:29:59.958632 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__connector_details:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
  
   as (
    with connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

connector_types as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

joined as (
    select
        c.connection_id,
        c.connection_name,
        ct.connector_name,
        ct.connector_type,
        d.destination_name,
        d.destination_type,
        c.created_at,
        c.is_paused,
        c.sync_frequency_minutes,
        c.is_deleted,
        c.destination_id
    from connections c
    left join connector_types ct on c.connector_type_id = ct.connector_type_id
    left join destinations d on c.destination_id = d.destination_id
)

select * from joined
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__connector_details"} */
 Succeeded [  0.67s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details (view)
21:29:59.959566 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__daily_api_calls:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

-- Filter to API call events
api_calls as (
    select
        connection_id,
        date_trunc('day', logged_at) as date_day,
        count(*) as api_calls_count
    from logs
    where event_type = 'api_call'
    group by 1, 2
),

-- Join with connection information
enriched_api_calls as (
    select
        a.date_day,
        a.connection_id,
        c.connection_name,
        c.destination_id,
        a.api_calls_count
    from api_calls a
    left join connections c on a.connection_id = c.connection_id
)

select * from enriched_api_calls
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__daily_api_calls"} */
 Succeeded [  0.67s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls (view)
21:30:00.067641 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:30:00.068728 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_sync_performance"
21:30:00.154775 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_daily_api_usage:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:30:00.156001 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_daily_api_usage"
21:30:00.156612 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_user_activity:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:30:00.157595 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_user_activity"
21:30:00.181111 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__daily_active_rows:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows
  
   as (
    with incremental_mar as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar
),

-- Aggregate to daily level
daily_active_rows as (
    select
        measured_date as date_day,
        connection_name,
        destination_id,
        schema_name,
        table_name,
        is_free,
        sum(incremental_rows) as active_rows
    from incremental_mar
    group by 1, 2, 3, 4, 5, 6
)

select * from daily_active_rows
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__daily_active_rows"} */
 Succeeded [  0.37s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows (view)
21:30:00.183030 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_monthly_active_rows"
21:30:00.472353 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_schema_change_history:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:30:00.474697 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_schema_change_history"
21:30:00.692690 [debug]: Query executed on node model.fivetran_analytics.my_second_dbt_model:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics.my_second_dbt_model
    
    
    
    as (
-- Use the `ref` function to select from other models

select *
from JASON_CHLETSOS.fivetran_analytics.my_first_dbt_model
where id = 1
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.my_second_dbt_model"} */
 Succeeded [  2.55s] model fivetran_analytics.my_second_dbt_model (table)
21:30:02.305880 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
    
    
    
    as (with sync_events as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Enrich with connector information
enriched_sync_events as (
    select
        se.sync_id,
        se.connection_id,
        se.connection_name,
        cd.connector_name,
        se.destination_name,
        se.sync_start_time,
        se.sync_end_time,
        se.sync_status,
        se.error_message,
        se.sync_duration_seconds,
        se.rows_synced,
        date_trunc('day', se.sync_start_time) as sync_date
    from sync_events se
    left join connector_details cd on se.connection_id = cd.connection_id
)

select * from enriched_sync_events
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_sync_performance"} */
 Succeeded [  2.35s] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
21:30:02.308920 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_sync_performance_trends"
21:30:02.308936 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_connector_health"
21:30:02.308991 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_error_monitoring"
21:30:02.370946 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_daily_api_usage:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage
    
    
    
    as (with daily_api_calls as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Enrich with connector and destination information
enriched_api_calls as (
    select
        dac.date_day,
        dac.connection_id,
        dac.connection_name,
        cd.connector_name,
        cd.destination_name,
        dac.api_calls_count
    from daily_api_calls dac
    left join connector_details cd on dac.connection_id = cd.connection_id
)

select * from enriched_api_calls
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_daily_api_usage"} */
 Succeeded [  2.41s] model fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage (table)
21:30:02.428273 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_user_activity:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity
    
    
    
    as (

with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

users as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Extract user activity events from logs
user_activity_events as (
    select
        logged_at,
        connection_id,
        event_type,
        message_type,
        message_content
    from logs
    where event_type in ('user_action', 'account_modification', 'setup')
),

-- Categorize user actions
categorized_actions as (
    select
        date_trunc('day', logged_at) as activity_date,
        connection_id,
        -- Determine action type
        case
            when message_type like '%create%' then 'Create'
            when message_type like '%update%' then 'Update'
            when message_type like '%delete%' then 'Delete'
            when message_type like '%enable%' then 'Enable'
            when message_type like '%disable%' then 'Disable'
            when message_type like '%pause%' then 'Pause'
            when message_type like '%resume%' then 'Resume'
            when message_type like '%sync%' then 'Sync'
            when message_type like '%login%' then 'Login'
            else 'Other'
        end as action_type,
        -- Determine resource type
        case
            when message_type like '%connection%' then 'Connection'
            when message_type like '%destination%' then 'Destination'
            when message_type like '%schema%' then 'Schema'
            when message_type like '%table%' then 'Table'
            when message_type like '%user%' then 'User'
            when message_type like '%account%' then 'Account'
            else 'Other'
        end as resource_type,
        -- Extract user information if available
        regexp_substr(message_content, 'by user ([^\\s]+)', 1, 1, 'e') as user_email,
        -- Extract resource name if available
        case
            when message_type like '%connection%' then 
                regexp_substr(message_content, 'connection ([^\\s]+)', 1, 1, 'e')
            when message_type like '%destination%' then 
                regexp_substr(message_content, 'destination ([^\\s]+)', 1, 1, 'e')
            when message_type like '%schema%' then 
                regexp_substr(message_content, 'schema ([^\\s]+)', 1, 1, 'e')
            when message_type like '%table%' then 
                regexp_substr(message_content, 'table ([^\\s]+)', 1, 1, 'e')
            else null
        end as resource_name,
        count(*) as activity_count
    from user_activity_events
    group by 1, 2, 3, 4, 5, 6
),

-- Enrich with user and connection information
enriched_user_activity as (
    select
        ca.activity_date,
        coalesce(u.user_id, 'unknown') as user_id,
        coalesce(ca.user_email, u.email, 'unknown') as user_email,
        concat(coalesce(u.first_name, ''), ' ', coalesce(u.last_name, '')) as user_name,
        ca.action_type,
        ca.resource_type,
        coalesce(ca.resource_name, cd.connection_name, 'unknown') as resource_name,
        ca.activity_count
    from categorized_actions ca
    left join users u on ca.user_email = u.email
    left join connector_details cd on ca.connection_id = cd.connection_id
)

select * from enriched_user_activity
order by activity_date desc, user_email, action_type
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_user_activity"} */
 Succeeded [  2.47s] model fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity (table)
21:30:02.714646 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_schema_change_history:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history
    
    
    
    as (

with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Extract schema change events from logs
schema_change_events as (
    select
        log_id,
        logged_at as change_detected_at,
        connection_id,
        message_type,
        message_content,
        -- Extract schema and table information from message content
        regexp_substr(message_content, 'schema ([^\\s]+)', 1, 1, 'e') as schema_name,
        regexp_substr(message_content, 'table ([^\\s\\.]+)', 1, 1, 'e') as table_name,
        -- Determine change type
        case
            when message_type like '%column_added%' then 'Column Added'
            when message_type like '%column_removed%' then 'Column Removed'
            when message_type like '%column_renamed%' then 'Column Renamed'
            when message_type like '%column_type_changed%' then 'Column Type Changed'
            when message_type like '%table_added%' then 'Table Added'
            when message_type like '%table_removed%' then 'Table Removed'
            when message_type like '%table_renamed%' then 'Table Renamed'
            when message_type like '%schema_added%' then 'Schema Added'
            when message_type like '%schema_removed%' then 'Schema Removed'
            when message_type like '%schema_renamed%' then 'Schema Renamed'
            else 'Other Schema Change'
        end as change_type,
        -- Extract column information
        regexp_substr(message_content, 'column ([^\\s]+)', 1, 1, 'e') as column_name,
        -- Extract data type information for type changes
        case 
            when message_type like '%column_type_changed%' then 
                regexp_substr(message_content, 'from ([^\\s]+) to', 1, 1, 'e')
            else null
        end as previous_data_type,
        case 
            when message_type like '%column_type_changed%' then 
                regexp_substr(message_content, 'to ([^\\s\\.]+)', 1, 1, 'e')
            else null
        end as new_data_type
    from logs
    where event_type = 'schema_change'
),

-- Enrich with connector information
enriched_schema_changes as (
    select
        sce.change_detected_at,
        cd.connection_name,
        cd.connector_name,
        sce.schema_name,
        sce.table_name,
        sce.change_type,
        sce.column_name,
        sce.previous_data_type,
        sce.new_data_type
    from schema_change_events sce
    left join connector_details cd on sce.connection_id = cd.connection_id
    where sce.schema_name is not null
)

select * from enriched_schema_changes
order by change_detected_at desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_schema_change_history"} */
 Succeeded [  2.76s] model fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history (table)
21:30:03.022581 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance_trends:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends
    
    
    
    as (

with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

-- Calculate daily sync metrics
daily_sync_metrics as (
    select
        sync_date,
        connection_name,
        connector_name,
        count(*) as sync_count,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,
        avg(sync_duration_seconds) as avg_sync_duration,
        max(sync_duration_seconds) as max_sync_duration,
        min(sync_duration_seconds) as min_sync_duration,
        sum(rows_synced) as total_rows_synced
    from sync_performance
    where sync_date >= dateadd(day, -90, current_date())
    group by 1, 2, 3
),

-- Calculate rolling averages
rolling_metrics as (
    select
        sync_date,
        connection_name,
        connector_name,
        sync_count,
        successful_syncs,
        failed_syncs,
        avg_sync_duration,
        max_sync_duration,
        min_sync_duration,
        total_rows_synced,
        -- Calculate 7-day rolling averages
        avg(avg_sync_duration) over (
            partition by connection_name, connector_name
            order by sync_date
            rows between 6 preceding and current row
        ) as rolling_7d_avg_duration,
        avg(total_rows_synced) over (
            partition by connection_name, connector_name
            order by sync_date
            rows between 6 preceding and current row
        ) as rolling_7d_avg_rows,
        -- Calculate success rate
        (successful_syncs / nullif(sync_count, 0)) * 100 as success_rate,
        -- Calculate 7-day rolling success rate
        avg((successful_syncs / nullif(sync_count, 0)) * 100) over (
            partition by connection_name, connector_name
            order by sync_date
            rows between 6 preceding and current row
        ) as rolling_7d_success_rate
    from daily_sync_metrics
)

select * from rolling_metrics
order by sync_date desc, connection_name, connector_name
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_sync_performance_trends"} */
 Succeeded [  0.72s] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends (table)
21:30:03.023391 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_health:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
    
    
    
    as (with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

-- Calculate last sync information
last_sync as (
    select
        connection_name,
        connector_name,
        destination_name,
        max(sync_end_time) as last_sync_at
    from sync_performance
    group by 1, 2, 3
),

-- Get status of the last sync
last_sync_status as (
    select
        sp.connection_name,
        sp.connector_name,
        sp.destination_name,
        sp.sync_status as last_sync_status
    from sync_performance sp
    inner join last_sync ls 
        on sp.connection_name = ls.connection_name
        and sp.sync_end_time = ls.last_sync_at
),

-- Calculate metrics for the last 7 days
recent_sync_metrics as (
    select
        connection_name,
        connector_name,
        destination_name,
        avg(sync_duration_seconds) as avg_sync_duration_seconds,
        count(*) as total_syncs_last_7d,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,
        (count(*) - sum(case when sync_status = 'error' then 1 else 0 end)) / nullif(count(*), 0) * 100 as success_rate_last_7d,
        sum(rows_synced) as total_rows_synced_last_7d
    from sync_performance
    where sync_date >= dateadd(day, -7, current_date())
    group by 1, 2, 3
),

-- Combine all metrics
connector_health as (
    select
        ls.connection_name,
        ls.connector_name,
        ls.destination_name,
        ls.last_sync_at,
        lss.last_sync_status,
        coalesce(rsm.avg_sync_duration_seconds, 0) as avg_sync_duration_seconds,
        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,
        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,
        coalesce(rsm.success_rate_last_7d, 0) as success_rate_last_7d,
        coalesce(rsm.total_rows_synced_last_7d, 0) as total_rows_synced_last_7d
    from last_sync ls
    left join last_sync_status lss 
        on ls.connection_name = lss.connection_name
        and ls.connector_name = lss.connector_name
        and ls.destination_name = lss.destination_name
    left join recent_sync_metrics rsm 
        on ls.connection_name = rsm.connection_name
        and ls.connector_name = rsm.connector_name
        and ls.destination_name = rsm.destination_name
)

select * from connector_health
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_connector_health"} */
21:30:03.023432 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_error_monitoring:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring
    
    
    
    as (with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

-- Filter to error syncs
error_syncs as (
    select
        sync_id,
        connection_name,
        connector_name,
        destination_name,
        sync_start_time,
        sync_end_time,
        error_message,
        -- Categorize errors
        case
            when error_message like '%API rate limit%' then 'API Rate Limit'
            when error_message like '%authentication%' or error_message like '%auth%' then 'Authentication'
            when error_message like '%permission%' or error_message like '%access denied%' then 'Permissions'
            when error_message like '%timeout%' then 'Timeout'
            when error_message like '%schema%' then 'Schema'
            when error_message like '%connection%' then 'Connection'
            else 'Other'
        end as error_type
    from sync_performance
    where sync_status = 'error'
),

-- Check if errors are recurring
recurring_errors as (
    select
        connection_name,
        error_type,
        count(*) as error_count
    from error_syncs
    where sync_start_time >= dateadd(day, -30, current_date())
    group by 1, 2
    having count(*) > 1
),

-- Final error monitoring table
error_monitoring as (
    select
        es.sync_id,
        es.connection_name,
        es.connector_name,
        es.destination_name,
        es.sync_start_time,
        es.sync_end_time,
        es.error_message,
        es.error_type,
        case 
            when re.connection_name is not null then true 
            else false 
        end as is_recurring_error
    from error_syncs es
    left join recurring_errors re 
        on es.connection_name = re.connection_name
        and es.error_type = re.error_type
)

select * from error_monitoring
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_error_monitoring"} */
 Succeeded [  0.72s] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
 Succeeded [  0.72s] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
21:30:03.025267 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_problematic_connectors"
21:30:03.429978 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_monthly_active_rows:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
    
    
    
    as (with daily_active_rows as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Aggregate to monthly level
monthly_active_rows as (
    select
        date_trunc('month', date_day) as month_date,
        connection_name,
        schema_name,
        table_name,
        sum(case when is_free then active_rows else 0 end) as free_active_rows,
        sum(case when not is_free then active_rows else 0 end) as paid_active_rows,
        sum(active_rows) as total_active_rows,
        max(destination_id) as destination_id
    from daily_active_rows
    group by 1, 2, 3, 4
),

-- Enrich with connector and destination information
enriched_monthly_active_rows as (
    select
        mar.month_date,
        mar.connection_name,
        cd.connector_name,
        cd.destination_name,
        mar.schema_name,
        mar.table_name,
        mar.free_active_rows,
        mar.paid_active_rows,
        mar.total_active_rows
    from monthly_active_rows mar
    left join connector_details cd on mar.connection_name = cd.connection_name
)

select * from enriched_monthly_active_rows
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_monthly_active_rows"} */
 Succeeded [  3.25s] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
21:30:03.432637 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_connector_recommendations"
21:30:03.432669 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_executive_dashboard"
21:30:03.736619 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_problematic_connectors:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors
    
    
    
    as (

with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

error_monitoring as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring
),

-- Calculate error metrics by connector
connector_error_metrics as (
    select
        connection_name,
        connector_name,
        destination_name,
        count(*) as total_syncs,
        sum(case when sync_status = 'error' then 1 else 0 end) as error_syncs,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,
        (sum(case when sync_status = 'error' then 1 else 0 end) / nullif(count(*), 0)) * 100 as error_rate,
        avg(sync_duration_seconds) as avg_sync_duration,
        max(sync_duration_seconds) as max_sync_duration
    from sync_performance
    where sync_date >= dateadd(day, -30, current_date())
    group by 1, 2, 3
),

-- Get recurring error information
recurring_error_counts as (
    select
        connection_name,
        connector_name,
        count(*) as recurring_error_count,
        count(distinct error_type) as distinct_error_types,
        max(sync_start_time) as last_error_time
    from error_monitoring
    where is_recurring_error = true
    group by 1, 2
),

-- Calculate a problem score based on multiple factors
problematic_connectors as (
    select
        cem.connection_name,
        cem.connector_name,
        cem.destination_name,
        cem.total_syncs,
        cem.error_syncs,
        cem.successful_syncs,
        cem.error_rate,
        cem.avg_sync_duration,
        cem.max_sync_duration,
        coalesce(rec.recurring_error_count, 0) as recurring_error_count,
        coalesce(rec.distinct_error_types, 0) as distinct_error_types,
        rec.last_error_time,
        -- Calculate a problem score (higher is worse)
        (cem.error_rate * 0.5) + 
        (coalesce(rec.recurring_error_count, 0) * 10) +
        (coalesce(rec.distinct_error_types, 0) * 5) +
        (case when rec.last_error_time is not null and rec.last_error_time >= dateadd(day, -1, current_timestamp()) then 20 else 0 end) as problem_score
    from connector_error_metrics cem
    left join recurring_error_counts rec 
        on cem.connection_name = rec.connection_name
        and cem.connector_name = rec.connector_name
)

select 
    *,
    case
        when problem_score >= 50 then 'Critical'
        when problem_score >= 30 then 'High'
        when problem_score >= 10 then 'Medium'
        else 'Low'
    end as problem_severity
from problematic_connectors
order by problem_score desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_problematic_connectors"} */
 Succeeded [  0.71s] model fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors (table)
21:30:04.499419 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_recommendations:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations
    
    
    
    as (

with connector_health as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
),

sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
    where sync_date >= dateadd(day, -30, current_date())
),

monthly_active_rows as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
    where month_date = date_trunc('month', current_date())
),

-- Calculate sync frequency metrics
sync_frequency as (
    select
        connection_name,
        connector_name,
        count(*) as sync_count,
        datediff(hour, min(sync_start_time), max(sync_start_time)) as hours_between_first_last_sync,
        count(*) / nullif(datediff(hour, min(sync_start_time), max(sync_start_time)), 0) * 24 as avg_syncs_per_day
    from sync_performance
    group by 1, 2
    having count(*) > 1
),

-- Calculate growth metrics
growth_metrics as (
    select
        connection_name,
        sum(total_active_rows) as total_active_rows,
        count(distinct schema_name || '.' || table_name) as tables_count
    from monthly_active_rows
    group by 1
),

-- Generate recommendations
connector_recommendations as (
    select
        ch.connection_name,
        ch.connector_name,
        ch.destination_name,
        ch.last_sync_at,
        ch.last_sync_status,
        ch.avg_sync_duration_seconds,
        coalesce(sf.avg_syncs_per_day, 0) as avg_syncs_per_day,
        coalesce(gm.total_active_rows, 0) as total_active_rows,
        coalesce(gm.tables_count, 0) as tables_count,
        
        -- Generate recommendations based on patterns
        case
            -- Sync frequency recommendations
            when coalesce(sf.avg_syncs_per_day, 0) > 12 and ch.avg_sync_duration_seconds < 60 
                then 'Consider reducing sync frequency - current frequency is high with fast syncs'
            when coalesce(sf.avg_syncs_per_day, 0) < 1 and coalesce(gm.total_active_rows, 0) > 1000000 
                then 'Consider increasing sync frequency for large data volume'
            
            -- Performance recommendations
            when ch.avg_sync_duration_seconds > 3600 
                then 'Long-running syncs detected - review connector configuration and optimize'
            when ch.success_rate_last_7d < 80 
                then 'Low success rate - investigate recurring errors'
            
            -- Usage recommendations
            when coalesce(gm.tables_count, 0) = 0 
                then 'No active tables - consider pausing or removing connector'
            when coalesce(gm.total_active_rows, 0) = 0 and ch.last_sync_status = 'success' 
                then 'Connector is syncing successfully but no active rows - review schema configuration'
            
            -- Health recommendations
            when ch.last_sync_status = 'error' 
                then 'Connector is currently failing - immediate attention required'
            when ch.last_sync_at < dateadd(day, -7, current_timestamp()) 
                then 'Connector has not synced in over a week - check if paused or experiencing issues'
            
            else 'Connector is performing as expected'
        end as primary_recommendation,
        
        -- Generate a recommendation score (higher means more attention needed)
        case
            when ch.last_sync_status = 'error' then 100
            when ch.last_sync_at < dateadd(day, -7, current_timestamp()) then 90
            when ch.success_rate_last_7d < 80 then 80
            when ch.avg_sync_duration_seconds > 3600 then 70
            when coalesce(gm.tables_count, 0) = 0 then 60
            when coalesce(gm.total_active_rows, 0) = 0 and ch.last_sync_status = 'success' then 50
            when coalesce(sf.avg_syncs_per_day, 0) > 12 and ch.avg_sync_duration_seconds < 60 then 40
            when coalesce(sf.avg_syncs_per_day, 0) < 1 and coalesce(gm.total_active_rows, 0) > 1000000 then 30
            else 0
        end as recommendation_score
        
    from connector_health ch
    left join sync_frequency sf on ch.connection_name = sf.connection_name
    left join growth_metrics gm on ch.connection_name = gm.connection_name
)

select 
    *,
    case
        when recommendation_score >= 80 then 'Critical'
        when recommendation_score >= 50 then 'High'
        when recommendation_score >= 30 then 'Medium'
        else 'Low'
    end as recommendation_priority
from connector_recommendations
order by recommendation_score desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_connector_recommendations"} */
 Succeeded [  1.07s] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
21:30:04.504001 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_executive_dashboard:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard
    
    
    
    as (

with monthly_active_rows as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
),

connector_health as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
),

error_monitoring as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring
    where sync_start_time >= dateadd(day, -30, current_date())
),

-- Calculate connector counts
connector_counts as (
    select
        count(distinct connection_name) as total_connectors,
        count(distinct case when last_sync_status = 'success' then connection_name end) as healthy_connectors,
        count(distinct case when last_sync_status = 'error' then connection_name end) as failing_connectors,
        count(distinct destination_name) as total_destinations
    from connector_health
),

-- Calculate active rows metrics
active_rows_metrics as (
    select
        sum(total_active_rows) as total_active_rows,
        sum(free_active_rows) as free_active_rows,
        sum(paid_active_rows) as paid_active_rows,
        count(distinct connection_name) as connections_with_mar,
        count(distinct schema_name || '.' || table_name) as total_tables_synced
    from monthly_active_rows
    where month_date = date_trunc('month', current_date())
),

-- Calculate error metrics
error_metrics as (
    select
        count(*) as total_errors,
        count(distinct connection_name) as connectors_with_errors,
        count(distinct case when is_recurring_error then connection_name end) as connectors_with_recurring_errors
    from error_monitoring
),

-- Combine all metrics for the dashboard
executive_dashboard as (
    select
        current_date() as report_date,
        cc.total_connectors,
        cc.healthy_connectors,
        cc.failing_connectors,
        cc.total_destinations,
        arm.total_active_rows,
        arm.free_active_rows,
        arm.paid_active_rows,
        arm.connections_with_mar,
        arm.total_tables_synced,
        em.total_errors,
        em.connectors_with_errors,
        em.connectors_with_recurring_errors,
        (cc.healthy_connectors / nullif(cc.total_connectors, 0)) * 100 as connector_health_percentage,
        (em.connectors_with_recurring_errors / nullif(cc.total_connectors, 0)) * 100 as recurring_error_percentage
    from connector_counts cc
    cross join active_rows_metrics arm
    cross join error_metrics em
)

select * from executive_dashboard
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_executive_dashboard"} */
 Succeeded [  1.07s] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:30:04.547629 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [9.3s]
Processed: 25 models
Summary: 25 total | 25 success
==================== 2025-11-15 21:48:48.014835 | 019a897e-0206-7362-9eda-cf16bafaa0a0 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:48:48.226541 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:48:48.226757 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:48:48.226764 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:48:49.256325 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:48:49.391354 [error]: dbt0209: Failed to resolve function DATE_TRUNC: No column MEASURED_AT found. Available are INCREMENTAL_MAR.MEASURED_DATE, INCREMENTAL_MAR.UPDATED_AT, INCREMENTAL_MAR.IS_FREE, INCREMENTAL_MAR.TABLE_NAME, INCREMENTAL_MAR.SCHEMA_NAME, INCREMENTAL_MAR.SYNC_TYPE, INCREMENTAL_MAR.DESTINATION_ID, INCREMENTAL_MAR.CONNECTION_NAME, INCREMENTAL_MAR._FIVETRAN_SYNCED, INCREMENTAL_MAR.INCREMENTAL_ROWS
  --> models/marts/usage/fct_fivetran_monthly_active_rows.sql:16:29 (target/compiled/models/marts/usage/fct_fivetran_monthly_active_rows.sql:14:29)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
21:48:49.728856 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_health:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:48:49.730071 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_connector_health"
21:48:50.565505 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_health:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
    
    
    
    as (

with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

-- Calculate last sync information
last_sync as (
    select
        connection_name,
        connector_name,
        destination_name,
        max(sync_end_time) as last_sync_at,
        max(case when sync_status = 'success' then sync_end_time else null end) as last_successful_sync_at,
        max(case when sync_status = 'error' then sync_end_time else null end) as last_error_sync_at
    from sync_performance
    group by 1, 2, 3
),

-- Calculate sync status
sync_status as (
    select
        ls.connection_name,
        ls.connector_name,
        ls.destination_name,
        ls.last_sync_at,
        ls.last_successful_sync_at,
        ls.last_error_sync_at,
        case
            when ls.last_sync_at = ls.last_successful_sync_at then 'success'
            when ls.last_sync_at = ls.last_error_sync_at then 'error'
            else 'unknown'
        end as last_sync_status
    from last_sync ls
),

-- Calculate sync metrics for all time (not just last 7 days)
sync_metrics as (
    select
        connection_name,
        connector_name,
        count(*) as total_syncs,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,
        avg(sync_duration_seconds) as avg_sync_duration_seconds,
        max(sync_duration_seconds) as max_sync_duration_seconds
    from sync_performance
    group by 1, 2
),

-- Calculate recent sync metrics (last 7 days if data exists)
recent_sync_metrics as (
    select
        connection_name,
        connector_name,
        count(*) as total_syncs_last_7d,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs_last_7d,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,
        case 
            when count(*) > 0 then 
                (sum(case when sync_status = 'success' then 1 else 0 end) / nullif(count(*), 0)) * 100 
            else null 
        end as success_rate_last_7d
    from sync_performance
    where sync_date >= dateadd(day, -7, current_date())
    group by 1, 2
),

-- Combine all metrics
connector_health as (
    select
        ss.connection_name,
        ss.connector_name,
        ss.destination_name,
        ss.last_sync_at,
        ss.last_successful_sync_at,
        ss.last_error_sync_at,
        ss.last_sync_status,
        coalesce(sm.total_syncs, 0) as total_syncs,
        coalesce(sm.successful_syncs, 0) as successful_syncs,
        coalesce(sm.failed_syncs, 0) as failed_syncs,
        sm.avg_sync_duration_seconds,
        sm.max_sync_duration_seconds,
        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,
        coalesce(rsm.successful_syncs_last_7d, 0) as successful_syncs_last_7d,
        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,
        coalesce(rsm.success_rate_last_7d, 
            case 
                when sm.total_syncs > 0 then 
                    (sm.successful_syncs / nullif(sm.total_syncs, 0)) * 100 
                else null 
            end
        ) as success_rate_last_7d
    from sync_status ss
    left join sync_metrics sm on ss.connection_name = sm.connection_name and ss.connector_name = sm.connector_name
    left join recent_sync_metrics rsm on ss.connection_name = rsm.connection_name and ss.connector_name = rsm.connector_name
)

select * from connector_health
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_connector_health"} */
 Succeeded [  1.15s] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:48:50.625335 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [2.6s]
Processed: 3 models
Summary: 3 total | 1 success | 1 error | 1 skipped
==================== 2025-11-15 21:50:37.980712 | 019a897f-af92-76f3-b7c7-f5e386d678fc ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:50:38.219122 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:50:38.219199 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:50:38.219205 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:50:39.060355 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:50:39.192723 [error]: dbt0227: No column CD.CONNECTOR_ID found. Available are MAR.CONNECTOR_ID, MCC.CONNECTOR_ID, CD.CONNECTION_ID, CD.CONNECTOR_NAME, CD.CONNECTOR_TYPE, CD.CONNECTION_NAME, CD.CREATED_AT ..(and 15 more)
  --> models/marts/usage/fct_fivetran_monthly_active_rows.sql:72:31 (target/compiled/models/marts/usage/fct_fivetran_monthly_active_rows.sql:70:31)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:50:39.235551 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [1.3s]
Processed: 2 models
Summary: 2 total | 1 error | 1 skipped
==================== 2025-11-15 21:52:44.870875 | 019a8981-9f44-77b1-920b-8a7c22fd4b6f ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:52:45.033619 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:52:45.033643 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:52:45.033648 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:52:45.881251 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:52:46.597310 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_monthly_active_rows:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:52:46.599766 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_monthly_active_rows"
21:52:49.260773 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_monthly_active_rows:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
    
    
    
    as (

with incremental_mar as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Get all months in the data
months as (
    select distinct 
        date_trunc('month', measured_date) as month_date
    from incremental_mar
),

-- Get all connector, schema, table combinations
connector_schema_tables as (
    select distinct
        connection_name,
        schema_name,
        table_name
    from incremental_mar
),

-- Create a cross join of all months and connector/schema/tables
month_connector_combinations as (
    select
        m.month_date,
        cst.connection_name,
        cst.schema_name,
        cst.table_name
    from months m
    cross join connector_schema_tables cst
),

-- Calculate monthly active rows
monthly_active_rows as (
    select
        date_trunc('month', measured_date) as month_date,
        connection_name,
        schema_name,
        table_name,
        sum(incremental_rows) as active_rows,
        sum(case when is_free then incremental_rows else 0 end) as free_active_rows,
        sum(case when not is_free then incremental_rows else 0 end) as paid_active_rows
    from incremental_mar
    group by 1, 2, 3, 4
),

-- Join with connector details
enriched_monthly_active_rows as (
    select
        mcc.month_date,
        mcc.connection_name,
        cd.connector_name,
        mcc.schema_name,
        mcc.table_name,
        coalesce(mar.free_active_rows, 0) as free_active_rows,
        coalesce(mar.paid_active_rows, 0) as paid_active_rows,
        coalesce(mar.active_rows, 0) as total_active_rows
    from month_connector_combinations mcc
    left join monthly_active_rows mar 
        on mcc.month_date = mar.month_date
        and mcc.connection_name = mar.connection_name
        and mcc.schema_name = mar.schema_name
        and mcc.table_name = mar.table_name
    left join connector_details cd 
        on mcc.connection_name = cd.connection_name
)

select * from enriched_monthly_active_rows
order by month_date desc, total_active_rows desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_monthly_active_rows"} */
 Succeeded [  3.15s] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
21:52:49.265343 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_connector_recommendations"
21:52:50.275127 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_recommendations:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations
    
    
    
    as (

with connector_health as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
),

sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

monthly_active_rows as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
),

-- Calculate sync frequency metrics
sync_frequency as (
    select
        connection_name,
        connector_name,
        count(*) as sync_count,
        datediff(hour, min(sync_start_time), max(sync_start_time)) as hours_between_first_last_sync,
        case 
            when datediff(hour, min(sync_start_time), max(sync_start_time)) > 0 
            then count(*) / nullif(datediff(hour, min(sync_start_time), max(sync_start_time)), 0) * 24 
            else null 
        end as avg_syncs_per_day
    from sync_performance
    group by 1, 2
    having count(*) > 1
),

-- Calculate growth metrics
growth_metrics as (
    select
        connection_name,
        sum(total_active_rows) as total_active_rows,
        count(distinct schema_name || '.' || table_name) as tables_count
    from monthly_active_rows
    group by 1
),

-- Generate recommendations
connector_recommendations as (
    select
        ch.connection_name,
        ch.connector_name,
        ch.destination_name,
        ch.last_sync_at,
        ch.last_sync_status,
        ch.avg_sync_duration_seconds,
        coalesce(sf.avg_syncs_per_day, 0) as avg_syncs_per_day,
        coalesce(gm.total_active_rows, 0) as total_active_rows,
        coalesce(gm.tables_count, 0) as tables_count,
        
        -- Generate recommendations based on patterns
        case
            -- Sync frequency recommendations
            when coalesce(sf.avg_syncs_per_day, 0) > 12 and ch.avg_sync_duration_seconds < 60 
                then 'Consider reducing sync frequency - current frequency is high with fast syncs'
            when coalesce(sf.avg_syncs_per_day, 0) < 1 and coalesce(gm.total_active_rows, 0) > 1000000 
                then 'Consider increasing sync frequency for large data volume'
            
            -- Performance recommendations
            when ch.avg_sync_duration_seconds > 3600 
                then 'Long-running syncs detected - review connector configuration and optimize'
            when ch.success_rate_last_7d < 80 
                then 'Low success rate - investigate recurring errors'
            
            -- Usage recommendations
            when coalesce(gm.tables_count, 0) = 0 
                then 'No active tables - consider pausing or removing connector'
            when coalesce(gm.total_active_rows, 0) = 0 and ch.last_sync_status = 'success' 
                then 'Connector is syncing successfully but no active rows - review schema configuration'
            
            -- Health recommendations
            when ch.last_sync_status = 'error' 
                then 'Connector is currently failing - immediate attention required'
            when ch.last_sync_at < dateadd(day, -7, current_timestamp()) 
                then 'Connector has not synced in over a week - check if paused or experiencing issues'
            
            else 'Connector is performing as expected'
        end as primary_recommendation,
        
        -- Generate a recommendation score (higher means more attention needed)
        case
            when ch.last_sync_status = 'error' then 100
            when ch.last_sync_at < dateadd(day, -7, current_timestamp()) then 90
            when ch.success_rate_last_7d < 80 then 80
            when ch.avg_sync_duration_seconds > 3600 then 70
            when coalesce(gm.tables_count, 0) = 0 then 60
            when coalesce(gm.total_active_rows, 0) = 0 and ch.last_sync_status = 'success' then 50
            when coalesce(sf.avg_syncs_per_day, 0) > 12 and ch.avg_sync_duration_seconds < 60 then 40
            when coalesce(sf.avg_syncs_per_day, 0) < 1 and coalesce(gm.total_active_rows, 0) > 1000000 then 30
            else 0
        end as recommendation_score
        
    from connector_health ch
    left join sync_frequency sf on ch.connection_name = sf.connection_name
    left join growth_metrics gm on ch.connection_name = gm.connection_name
)

select 
    *,
    case
        when recommendation_score >= 80 then 'Critical'
        when recommendation_score >= 50 then 'High'
        when recommendation_score >= 30 then 'Medium'
        else 'Low'
    end as recommendation_priority
from connector_recommendations
order by recommendation_score desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_connector_recommendations"} */
 Succeeded [  1.02s] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:52:50.341659 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [5.5s]
Processed: 2 models
Summary: 2 total | 2 success
==================== 2025-11-15 21:54:25.687120 | 019a8983-2915-75b2-aac7-c1b55d6cab75 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:54:25.856236 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:54:25.856260 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:54:25.856265 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:54:26.499752 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:54:26.597368 [error]: dbt0227: No column EL.CONNECTION_NAME found. Available are FS.CONNECTION_NAME, FS.CONNECTOR_NAME, EL.CONNECTION_ID, FS.SYNC_DATE, FS.SYNC_END_TIME, FS.SYNC_START_TIME, EL.EVENT_TYPE ..(and 8 more)
  --> models/marts/monitoring/fct_fivetran_error_monitoring.sql:59:33 (target/compiled/models/marts/monitoring/fct_fivetran_error_monitoring.sql:57:33)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:54:26.628789 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [941ms]
Processed: 2 models
Summary: 2 total | 1 error | 1 skipped
==================== 2025-11-15 21:56:25.852989 | 019a8984-fe7b-7fc2-b0b7-270dccae1a89 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:56:26.020178 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:56:26.020209 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:56:26.020215 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
21:56:26.625677 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
21:56:27.118951 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_error_monitoring:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
21:56:27.120660 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_error_monitoring"
21:56:27.853192 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_error_monitoring:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring
    
    
    
    as (

with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
    -- Remove date filter to include all data
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Get error logs
error_logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
    where event_type = 'error'
),

-- Get failed syncs
failed_syncs as (
    select
        sync_id,
        connection_name,
        connector_name,
        sync_start_time,
        sync_end_time,
        sync_date,
        rows_synced
    from sync_performance
    where sync_status = 'error'
),

-- Create simple error types based on sync failures
sync_errors as (
    select
        fs.sync_id,
        fs.connection_name,
        fs.connector_name,
        fs.sync_start_time,
        fs.sync_end_time,
        fs.sync_date,
        fs.rows_synced,
        'Sync Failure' as error_message,
        'Sync Error' as error_type
    from failed_syncs fs
),

-- Identify recurring errors
recurring_errors as (
    select
        connection_name,
        connector_name,
        error_type,
        count(*) as occurrence_count
    from sync_errors
    group by 1, 2, 3
    having count(*) > 1
),

-- Flag recurring errors
flagged_errors as (
    select
        se.*,
        case when re.connection_name is not null then true else false end as is_recurring_error,
        coalesce(re.occurrence_count, 1) as error_occurrence_count
    from sync_errors se
    left join recurring_errors re 
        on se.connection_name = re.connection_name
        and se.connector_name = re.connector_name
        and se.error_type = re.error_type
)

select * from flagged_errors
order by sync_start_time desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_error_monitoring"} */
 Succeeded [  1.07s] model fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring (table)
21:56:27.854583 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_executive_dashboard"
21:56:29.055604 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_executive_dashboard:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard
    
    
    
    as (

with connector_health as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
),

monthly_active_rows as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
),

error_monitoring as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring
    -- Remove date filter to include all data
),

-- Calculate connector health metrics
connector_health_metrics as (
    select
        current_date() as report_date,
        count(distinct connection_name) as total_connectors,
        sum(case when last_sync_status = 'success' then 1 else 0 end) as healthy_connectors,
        sum(case when last_sync_status = 'error' then 1 else 0 end) as failing_connectors,
        (sum(case when last_sync_status = 'success' then 1 else 0 end) / 
         nullif(count(distinct connection_name), 0)) * 100 as connector_health_percentage
    from connector_health
),

-- Calculate active rows metrics
active_rows_metrics as (
    select
        current_date() as report_date,
        sum(total_active_rows) as total_active_rows,
        sum(paid_active_rows) as paid_active_rows,
        sum(free_active_rows) as free_active_rows
    from monthly_active_rows
    -- Use the most recent month if available
    where month_date = (select max(month_date) from monthly_active_rows)
),

-- Calculate error metrics
error_metrics as (
    select
        current_date() as report_date,
        count(*) as total_errors,
        count(distinct connection_name) as connectors_with_errors,
        count(distinct case when is_recurring_error then connection_name else null end) as connectors_with_recurring_errors
    from error_monitoring
),

-- Combine all metrics
executive_dashboard as (
    select
        chm.report_date,
        chm.total_connectors,
        chm.healthy_connectors,
        chm.failing_connectors,
        chm.connector_health_percentage,
        coalesce(arm.total_active_rows, 0) as total_active_rows,
        coalesce(arm.paid_active_rows, 0) as paid_active_rows,
        coalesce(arm.free_active_rows, 0) as free_active_rows,
        coalesce(em.total_errors, 0) as total_errors,
        coalesce(em.connectors_with_errors, 0) as connectors_with_errors,
        coalesce(em.connectors_with_recurring_errors, 0) as connectors_with_recurring_errors
    from connector_health_metrics chm
    left join active_rows_metrics arm on chm.report_date = arm.report_date
    left join error_metrics em on chm.report_date = em.report_date
)

select * from executive_dashboard
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_executive_dashboard"} */
 Succeeded [  1.20s] model fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
21:56:29.106845 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [3.3s]
Processed: 2 models
Summary: 2 total | 2 success
==================== 2025-11-15 21:57:31.579801 | 019a8985-ff39-7f03-b0e5-146a573aefc6 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
21:57:31.742784 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
21:57:31.742814 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
21:57:31.742820 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
21:57:32.293062 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [713ms]
==================== 2025-11-15 22:04:00.645224 | 019a898b-eefc-72e2-aefa-ca92a583134a ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:04:00.851288 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:04:00.851502 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:04:00.851508 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:04:01.856123 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.2s]
==================== 2025-11-15 22:04:14.324090 | 019a898c-2472-7221-97b6-efe08a87ca2c ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:04:14.488151 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:04:14.488183 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:04:14.488189 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:04:15.045072 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:15.675539 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
22:04:15.676732 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_sync_performance"
22:04:17.461429 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
    
    
    
    as (with sync_events as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Enrich with connector information
enriched_sync_events as (
    select
        se.sync_id,
        se.connection_id,
        se.connection_name,
        cd.connector_name,
        se.destination_name,
        se.sync_start_time,
        se.sync_end_time,
        se.sync_status,
        se.error_message,
        se.sync_duration_seconds,
        se.rows_synced,
        date_trunc('day', se.sync_start_time) as sync_date
    from sync_events se
    left join connector_details cd on se.connection_id = cd.connection_id
)

select * from enriched_sync_events
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_sync_performance"} */
 Succeeded [  2.33s] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:04:17.509959 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [3.2s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:04:25.359828 | 019a898c-4f8d-7ec1-bb79-5a5c8e5ce1fa ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:04:25.519547 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:04:25.519573 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:04:25.519578 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:04:26.154735 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:26.757665 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:04:26.758456 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
22:04:27.392393 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

-- Extract sync start events
sync_starts as (
    select
        sync_id,
        connection_id,
        logged_at as sync_start_time
    from logs
    where event_type = 'sync_start'
),

-- Extract sync end events
sync_ends as (
    select
        sync_id,
        connection_id,
        logged_at as sync_end_time,
        case 
            when message_type = 'sync_error' then 'error'
            when message_type = 'sync_cancelled' then 'cancelled'
            else 'success'
        end as sync_status,
        case 
            when message_type = 'sync_error' then message_content
            else null
        end as error_message
    from logs
    where event_type = 'sync_end'
),

-- Extract row count information
row_counts as (
    select
        sync_id,
        connection_id,
        try_cast(regexp_substr(message_content, '\\d+') as integer) as rows_synced
    from logs
    where event_type = 'sync_end' 
    and message_type = 'synced_rows'
),

-- Combine all sync information
combined_syncs as (
    select
        ss.sync_id,
        ss.connection_id,
        c.connection_name,
        ss.sync_start_time,
        se.sync_end_time,
        se.sync_status,
        se.error_message,
        datediff(second, ss.sync_start_time, se.sync_end_time) as sync_duration_seconds,
        coalesce(rc.rows_synced, 0) as rows_synced,
        c.destination_id,
        d.destination_name
    from sync_starts ss
    left join sync_ends se on ss.sync_id = se.sync_id
    left join row_counts rc on ss.sync_id = rc.sync_id
    left join connections c on ss.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
    where se.sync_end_time is not null -- Only include completed syncs
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  1.15s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:04:27.430992 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [2.1s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:04:48.645999 | 019a898c-aa84-7e12-8b50-399031075d93 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:04:48.806610 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:04:48.806639 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:04:48.806647 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:04:49.566014 [debug]: Query executed on node unknown:
SELECT 'Source: connection' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connection
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:49.566365 [info ]: Source: connection - 186
22:04:49.783858 [debug]: Query executed on node unknown:
SELECT 'Source: log' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.log
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:49.784135 [info ]: Source: log - 267651
22:04:49.981745 [debug]: Query executed on node unknown:
SELECT 'Source: incremental_mar' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.incremental_mar
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:49.981966 [info ]: Source: incremental_mar - 125818
22:04:50.309638 [debug]: Query executed on node unknown:
SELECT 'Staging: stg_fivetran_log__log' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:50.309889 [info ]: Staging: stg_fivetran_log__log - 267651
22:04:51.154850 [debug]: Query executed on node unknown:
SELECT 'Intermediate: int_fivetran_log__sync_events' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:51.155066 [info ]: Intermediate: int_fivetran_log__sync_events - 0
22:04:51.414591 [debug]: Query executed on node unknown:
SELECT 'Mart: fct_fivetran_sync_performance' as table_name, COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:04:51.414810 [info ]: Mart: fct_fivetran_sync_performance - 0
New version available 2.0.0-preview.67 (run `dbt system update`)
22:04:51.443468 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [2.8s]
==================== 2025-11-15 22:05:08.053557 | 019a898c-f654-7180-92e7-37291f30cdcc ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:05:08.212138 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:05:08.212165 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:05:08.212170 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:05:08.638816 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [585ms]
==================== 2025-11-15 22:05:19.817465 | 019a898d-2448-7322-b136-cfe09be2f0c9 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:05:19.983354 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:05:19.983383 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:05:19.983389 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:05:20.813925 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [996ms]
==================== 2025-11-15 22:05:33.855034 | 019a898d-5b1d-73f2-8f6e-0fa1a5fddcb8 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:05:34.015517 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:05:34.015547 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:05:34.015554 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:05:34.885506 [debug]: Query executed on node unknown:
SELECT DISTINCT event_type FROM JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:05:34.886224 [info ]: Event type: INFO
22:05:34.886288 [info ]: Event type: SEVERE
22:05:34.886304 [info ]: Event type: WARNING
New version available 2.0.0-preview.67 (run `dbt system update`)
22:05:34.913712 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.1s]
==================== 2025-11-15 22:05:58.692633 | 019a898d-bc23-7491-85bb-93fe920d258d ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:05:58.856773 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:05:58.856805 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:05:58.856812 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:05:59.555331 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:05:59.634109 [error]: dbt0227: No column ID found. Available are LOGS.LOG_ID, LOGS.SYNC_ID, LOGS.LOGGED_AT, LOGS.EVENT_TYPE, LOGS.CONNECTION_ID, LOGS.MESSAGE_TYPE, LOGS._FIVETRAN_SYNCED ..(and 1 more)
  --> models/intermediate/int_fivetran_log__sync_events.sql:16:9 (target/compiled/models/intermediate/int_fivetran_log__sync_events.sql:16:9)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:05:59.666831 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [974ms]
Processed: 1 model
Summary: 1 total | 1 error
==================== 2025-11-15 22:06:15.420216 | 019a898d-fd7a-7fd2-9af1-76f8b3655955 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:06:15.582776 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:06:15.582804 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:06:15.582811 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:06:17.148243 [debug]: Query executed on node unknown:
SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'FIVETRAN_ANALYTICS_STG_FIVETRAN_LOG'
AND table_name = 'STG_FIVETRAN_LOG__LOG'
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:06:17.148509 [info ]: Column name: LOG_ID
22:06:17.148556 [info ]: Column name: MESSAGE_CONTENT
22:06:17.148569 [info ]: Column name: LOGGED_AT
22:06:17.148580 [info ]: Column name: SYNC_ID
22:06:17.148590 [info ]: Column name: MESSAGE_TYPE
22:06:17.148600 [info ]: Column name: CONNECTION_ID
22:06:17.148609 [info ]: Column name: EVENT_TYPE
22:06:17.148618 [info ]: Column name: _FIVETRAN_SYNCED
New version available 2.0.0-preview.67 (run `dbt system update`)
22:06:17.174628 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.8s]
==================== 2025-11-15 22:06:37.205209 | 019a898e-5293-7d61-8883-5fb6509364f3 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:06:37.364673 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:06:37.364706 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:06:37.364713 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:06:38.070345 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:06:38.638729 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:06:38.639789 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
22:06:39.180590 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

-- Extract sync information from logs
sync_logs as (
    select
        log_id,
        sync_id,
        connection_id,
        logged_at as sync_time,
        message_content,
        event_type,
        case 
            when event_type = 'SEVERE' then 'error'
            when event_type = 'WARNING' then 'warning'
            else 'info'
        end as sync_status
    from logs
    where message_content like '%sync%' or message_content like '%Sync%'
),

-- Group by connection to get sync metrics
connection_syncs as (
    select
        connection_id,
        min(sync_time) as first_sync_time,
        max(sync_time) as last_sync_time,
        count(*) as sync_count,
        sum(case when sync_status = 'error' then 1 else 0 end) as error_count
    from sync_logs
    group by 1
),

-- Join with connection and destination information
combined_syncs as (
    select
        cs.connection_id,
        c.connection_name,
        cs.first_sync_time,
        cs.last_sync_time,
        cs.sync_count,
        cs.error_count,
        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,
        c.destination_id,
        d.destination_name
    from connection_syncs cs
    left join connections c on cs.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  1.01s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:06:39.215053 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [2.0s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:06:44.777913 | 019a898e-7028-7c62-ac5b-343c6b8222af ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:06:44.937678 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:06:44.937705 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:06:44.937711 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:06:45.323270 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [545ms]
==================== 2025-11-15 22:06:51.528096 | 019a898e-8a86-7a80-b9c0-60a518042228 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:06:51.691978 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:06:51.692005 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:06:51.692010 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:06:52.012347 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [484ms]
==================== 2025-11-15 22:06:58.503651 | 019a898e-a5c6-74b0-9182-12ade35e6034 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:06:58.665848 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:06:58.665875 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:06:58.665879 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:06:59.307023 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [803ms]
==================== 2025-11-15 22:07:04.771012 | 019a898e-be41-7550-b365-ac41f6d1a76b ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:07:04.929260 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:07:04.929289 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:07:04.929295 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:07:05.277458 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [506ms]
==================== 2025-11-15 22:09:03.707955 | 019a8990-8edb-7b80-b607-86a5cb7bd1af ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:09:03.868169 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:09:03.868195 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:09:03.868200 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:09:04.844738 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.1s]
==================== 2025-11-15 22:09:10.623235 | 019a8990-a9de-7091-bb5c-f30d8f204ddb ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:09:10.787181 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:09:10.787213 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:09:10.787219 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:09:11.124782 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [501ms]
==================== 2025-11-15 22:12:13.808257 | 019a8993-756f-7001-9f26-eab6d59738b0 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:12:13.965254 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:12:13.965283 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:12:13.965290 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:12:16.081755 [debug]: Query executed on node unknown:
SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG'
AND table_name = 'CONNECTION'
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:12:16.082095 [info ]: Columns for CONNECTION:
New version available 2.0.0-preview.67 (run `dbt system update`)
22:12:16.112982 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [2.3s]
==================== 2025-11-15 22:12:27.036523 | 019a8993-a91b-7b81-9983-49a9c5df1f50 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:12:27.195193 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:12:27.195221 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:12:27.195227 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:12:27.599716 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [563ms]
==================== 2025-11-15 22:14:23.257137 | 019a8995-6f18-7152-ac13-b4cef3e71bf8 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:14:23.418951 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:14:23.418978 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:14:23.418984 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:14:24.263826 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:14:24.322475 [error]: dbt0227: No column CONNECTIONS.CONNECTOR_ID found. Available are CONNECTIONS.CONNECTION_ID, CONNECTOR_TYPES.CONNECTOR_NAME, CONNECTOR_TYPES.CONNECTOR_TYPE, CONNECTIONS.CONNECTOR_TYPE_ID, CONNECTOR_TYPES.CONNECTOR_TYPE_ID, CONNECTIONS.CONNECTION_NAME, DESTINATIONS.ACCOUNT_ID ..(and 22 more)
  --> models/intermediate/int_fivetran_log__connector_details.sql:24:9 (target/compiled/models/intermediate/int_fivetran_log__connector_details.sql:24:9)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
22:14:24.361498 [error]: dbt0227: No column C.CONNECTOR_NAME found. Available are C.CONNECTION_NAME, C.CONNECTION_ID, CS.CONNECTION_ID, C.CONNECTOR_TYPE_ID, C.CREATED_AT, D.CREATED_AT, D.DESTINATION_NAME ..(and 19 more)
  --> models/intermediate/int_fivetran_log__sync_events.sql:56:9 (target/compiled/models/intermediate/int_fivetran_log__sync_events.sql:56:9)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:14:24.398217 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 2 errors for target 'dev' [1.1s]
Processed: 3 models
Summary: 3 total | 2 error | 1 skipped
==================== 2025-11-15 22:14:33.834274 | 019a8995-9869-7900-8174-d4ef3cf63be8 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:14:33.993339 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:14:33.993366 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:14:33.993373 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:14:34.369013 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [534ms]
==================== 2025-11-15 22:15:14.061888 | 019a8996-358c-7121-8d10-65d8335c9c0d ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:15:14.221851 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:15:14.221877 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:15:14.221884 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:15:14.949533 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:15:15.003696 [error]: dbt0227: No column CONNECTIONS.SET_UP_AT found. Available are CONNECTIONS.CREATED_AT, CONNECTOR_TYPES.CREATED_AT, DESTINATIONS.CREATED_AT, CONNECTOR_TYPES.RELEASED_AT, DESTINATIONS.ACCOUNT_ID, CONNECTIONS.IS_PAUSED, DESTINATIONS.REGION ..(and 22 more)
  --> models/intermediate/int_fivetran_log__connector_details.sql:29:9 (target/compiled/models/intermediate/int_fivetran_log__connector_details.sql:29:9)
   Skipped [-------] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
22:15:15.538939 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:15:15.539665 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
22:15:15.936334 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

connector_types as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
),

-- Extract sync information from message content
sync_logs as (
    select
        log_id,
        sync_id,
        connection_id,
        logged_at as sync_time,
        message_content,
        event_type,
        case 
            when event_type = 'SEVERE' then 'error'
            when event_type = 'WARNING' then 'warning'
            else 'info'
        end as sync_status,
        case
            when message_content like '%rows synced%' then
                try_cast(regexp_substr(message_content, '[0-9]+') as integer)
            else null
        end as rows_synced
    from logs
    where message_content like '%sync%' 
       or message_content like '%Sync%'
       or message_content like '%rows synced%'
),

-- Group by connection to get sync metrics
connection_syncs as (
    select
        connection_id,
        min(sync_time) as first_sync_time,
        max(sync_time) as last_sync_time,
        count(*) as sync_count,
        sum(case when sync_status = 'error' then 1 else 0 end) as error_count,
        sum(coalesce(rows_synced, 0)) as total_rows_synced
    from sync_logs
    group by 1
),

-- Join with connection and destination information
combined_syncs as (
    select
        cs.connection_id,
        c.connection_name,
        ct.connector_name,
        cs.first_sync_time,
        cs.last_sync_time,
        cs.sync_count,
        cs.error_count,
        cs.total_rows_synced,
        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,
        c.destination_id,
        d.destination_name
    from connection_syncs cs
    left join connections c on cs.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
    left join connector_types ct on c.connector_type_id = ct.connector_type_id
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  0.89s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:15:15.984174 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [1.9s]
Processed: 3 models
Summary: 3 total | 1 success | 1 error | 1 skipped
==================== 2025-11-15 22:15:40.883797 | 019a8996-9e52-7231-b7bf-ab5b2484fbd9 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:15:41.040793 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:15:41.040819 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:15:41.040824 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:15:41.662479 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [778ms]
==================== 2025-11-15 22:15:55.236031 | 019a8996-d663-7c53-8131-346e247f3f85 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:15:55.394573 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:15:55.394600 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:15:55.394606 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:15:55.814756 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [578ms]
==================== 2025-11-15 22:16:23.109333 | 019a8997-4343-7b21-8bd8-7ccb2e26e9b0 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:16:23.269986 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:16:23.270013 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:16:23.270018 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:16:23.945372 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:16:23.994445 [error]: dbt0227: No column CONNECTIONS.STATUS found. Available are DESTINATIONS.IS_ACTIVE, CONNECTIONS.IS_PAUSED, DESTINATIONS.REGION, CONNECTIONS.CREATED_AT, CONNECTOR_TYPES.CREATED_AT, DESTINATIONS.CREATED_AT, CONNECTIONS.IS_DELETED ..(and 22 more)
  --> models/intermediate/int_fivetran_log__connector_details.sql:29:9 (target/compiled/models/intermediate/int_fivetran_log__connector_details.sql:29:9)
22:16:24.396685 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:16:24.397435 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
22:16:25.020558 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

connector_types as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
),

-- Extract sync information from message content
sync_logs as (
    select
        log_id,
        sync_id,
        connection_id,
        logged_at as sync_time,
        message_content,
        event_type,
        case 
            when event_type = 'SEVERE' then 'error'
            when event_type = 'WARNING' then 'warning'
            else 'info'
        end as sync_status,
        case
            when message_content like '%rows synced%' then
                try_cast(regexp_substr(message_content, '[0-9]+') as integer)
            else null
        end as rows_synced
    from logs
    where message_content like '%sync%' 
       or message_content like '%Sync%'
       or message_content like '%rows synced%'
),

-- Group by connection to get sync metrics
connection_syncs as (
    select
        connection_id,
        min(sync_time) as first_sync_time,
        max(sync_time) as last_sync_time,
        count(*) as sync_count,
        sum(case when sync_status = 'error' then 1 else 0 end) as error_count,
        sum(coalesce(rows_synced, 0)) as total_rows_synced
    from sync_logs
    group by 1
),

-- Join with connection and destination information
combined_syncs as (
    select
        cs.connection_id,
        c.connection_name,
        ct.connector_name,
        cs.first_sync_time,
        cs.last_sync_time,
        cs.sync_count,
        cs.error_count,
        cs.total_rows_synced,
        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,
        c.destination_id,
        d.destination_name
    from connection_syncs cs
    left join connections c on cs.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
    left join connector_types ct on c.connector_type_id = ct.connector_type_id
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  0.99s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:16:25.055437 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [1.9s]
Processed: 2 models
Summary: 2 total | 1 success | 1 error
==================== 2025-11-15 22:16:53.515555 | 019a8997-ba0a-7d12-97b3-16d5bf29adb1 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:16:53.672811 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:16:53.672837 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:16:53.672843 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:16:54.305015 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:16:54.696817 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__connector_details:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:16:54.698786 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__connector_details"
22:16:55.001336 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_INT_FIVETRAN_LOG" LIMIT 10000
22:16:55.002297 [debug]: Writing runtime sql for node "model.fivetran_analytics.int_fivetran_log__sync_events"
22:16:55.200806 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__connector_details:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
  
   as (
    with connections as (
    
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection

),

destinations as (

    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination

),

connector_types as (

    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type

),

connector_details as (

    select
        connections.connection_id,
        connections.connection_name,
        connections.connector_type_id,
        connector_types.connector_name,
        connections.created_at as connection_created_at,
        connections.destination_id,
        destinations.destination_name,
        connections.is_paused
    from connections
    left join destinations 
        on connections.destination_id = destinations.destination_id
    left join connector_types 
        on connections.connector_type_id = connector_types.connector_type_id

)

select * from connector_details
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__connector_details"} */
 Succeeded [  0.85s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details (view)
22:16:55.618523 [debug]: Query executed on node model.fivetran_analytics.int_fivetran_log__sync_events:
create or replace   view JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events
  
   as (
    with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connections as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection
),

destinations as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination
),

connector_types as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type
),

-- Extract sync information from message content
sync_logs as (
    select
        log_id,
        sync_id,
        connection_id,
        logged_at as sync_time,
        message_content,
        event_type,
        case 
            when event_type = 'SEVERE' then 'error'
            when event_type = 'WARNING' then 'warning'
            else 'info'
        end as sync_status,
        case
            when message_content like '%rows synced%' then
                try_cast(regexp_substr(message_content, '[0-9]+') as integer)
            else null
        end as rows_synced
    from logs
    where message_content like '%sync%' 
       or message_content like '%Sync%'
       or message_content like '%rows synced%'
),

-- Group by connection to get sync metrics
connection_syncs as (
    select
        connection_id,
        min(sync_time) as first_sync_time,
        max(sync_time) as last_sync_time,
        count(*) as sync_count,
        sum(case when sync_status = 'error' then 1 else 0 end) as error_count,
        sum(coalesce(rows_synced, 0)) as total_rows_synced
    from sync_logs
    group by 1
),

-- Join with connection and destination information
combined_syncs as (
    select
        cs.connection_id,
        c.connection_name,
        ct.connector_name,
        cs.first_sync_time,
        cs.last_sync_time,
        cs.sync_count,
        cs.error_count,
        cs.total_rows_synced,
        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,
        c.destination_id,
        d.destination_name
    from connection_syncs cs
    left join connections c on cs.connection_id = c.connection_id
    left join destinations d on c.destination_id = d.destination_id
    left join connector_types ct on c.connector_type_id = ct.connector_type_id
)

select * from combined_syncs
  )
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.int_fivetran_log__sync_events"} */
 Succeeded [  1.23s] model fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events (view)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:16:55.653114 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [2.1s]
Processed: 2 models
Summary: 2 total | 2 success
==================== 2025-11-15 22:17:30.238474 | 019a8998-497d-7102-8214-dbc7f00c136c ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:17:30.395948 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:17:30.395974 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:17:30.395979 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:17:31.091777 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:17:31.518522 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
22:17:31.519628 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_sync_performance"
22:17:33.540669 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_sync_performance:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
    
    
    
    as (

with logs as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Extract detailed sync information from logs
detailed_syncs as (
    select
        l.log_id,
        l.sync_id,
        l.connection_id,
        l.logged_at as sync_time,
        cd.connection_name,
        cd.connector_name,
        cd.destination_name,
        date(l.logged_at) as sync_date,
        l.event_type,
        l.message_content,
        case 
            when l.event_type = 'SEVERE' then 'error'
            when l.event_type = 'WARNING' then 'warning'
            else 'success'
        end as sync_status,
        case
            when l.message_content like '%rows synced%' then
                try_cast(regexp_substr(l.message_content, '[0-9]+') as integer)
            else null
        end as rows_synced
    from logs l
    join connector_details cd on l.connection_id = cd.connection_id
    where l.message_content like '%sync%' 
       or l.message_content like '%Sync%'
       or l.message_content like '%rows synced%'
),

-- Group syncs by ID to get metrics
sync_metrics as (
    select
        sync_id,
        connection_id,
        connection_name,
        connector_name,
        destination_name,
        min(sync_time) as sync_start_time,
        max(sync_time) as sync_end_time,
        date(min(sync_time)) as sync_date,
        max(case when sync_status = 'error' then 1 else 0 end) > 0 as has_errors,
        max(rows_synced) as rows_synced
    from detailed_syncs
    where sync_id is not null
    group by 1, 2, 3, 4, 5
),

-- Calculate final metrics
final_syncs as (
    select
        sync_id,
        connection_id,
        connection_name,
        connector_name,
        destination_name,
        sync_start_time,
        sync_end_time,
        sync_date,
        case when has_errors then 'error' else 'success' end as sync_status,
        datediff(second, sync_start_time, sync_end_time) as sync_duration_seconds,
        coalesce(rows_synced, 0) as rows_synced
    from sync_metrics
)

select * from final_syncs
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_sync_performance"} */
 Succeeded [  2.34s] model fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:17:33.588017 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [3.3s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:17:47.774474 | 019a8998-8dfd-75a1-b80b-daf705c05a32 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:17:47.931670 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:17:47.931694 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:17:47.931699 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:17:48.300876 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [526ms]
==================== 2025-11-15 22:19:28.043610 | 019a899a-15aa-7ec3-a993-d8a5afd21378 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:19:28.203942 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:19:28.203969 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:19:28.203975 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:19:29.173340 [debug]: Query executed on node unknown:
SELECT COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:19:29.173584 [info ]: Sync Performance row count: 144
22:19:29.537023 [debug]: Query executed on node unknown:
SELECT * FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance LIMIT 5
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:19:29.537211 [info ]: Sample row: sync_id=a8dfa474-c20b-4d58-a6f9-53b51cf08199, connection=jason_chletsos_demo_sql_server, status=success
22:19:29.537253 [info ]: Sample row: sync_id=e6ac5a9d-8dd8-4a19-8bee-678a9fccd7c8, connection=oracle_rds_sasajima, status=success
22:19:29.537269 [info ]: Sample row: sync_id=d7339a70-a6b8-4332-925e-7c8158a7f904, connection=snow_test, status=success
22:19:29.537283 [info ]: Sample row: sync_id=aa5b5807-6ca8-49ff-8732-5a28aae449df, connection=jason_chletsos_demo_sql_server, status=success
22:19:29.537295 [info ]: Sample row: sync_id=a52d16ea-1a27-4c08-98b5-9ed2c93cd144, connection=fivetran_log, status=success
New version available 2.0.0-preview.67 (run `dbt system update`)
22:19:29.561806 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.5s]
==================== 2025-11-15 22:19:59.591018 | 019a899a-90e6-73b3-8f51-c08a86e35c56 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:19:59.746914 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:19:59.746938 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:19:59.746943 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:20:00.564888 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:20:01.165835 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_health:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
22:20:01.166936 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_connector_health"
22:20:02.623696 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_connector_health:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
    
    
    
    as (

with sync_performance as (
    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance
),

-- Calculate last sync information
last_sync as (
    select
        connection_name,
        connector_name,
        destination_name,
        max(sync_end_time) as last_sync_at,
        max(case when sync_status = 'success' then sync_end_time else null end) as last_successful_sync_at,
        max(case when sync_status = 'error' then sync_end_time else null end) as last_error_sync_at
    from sync_performance
    group by 1, 2, 3
),

-- Calculate sync status
sync_status as (
    select
        ls.connection_name,
        ls.connector_name,
        ls.destination_name,
        ls.last_sync_at,
        ls.last_successful_sync_at,
        ls.last_error_sync_at,
        case
            when ls.last_sync_at = ls.last_successful_sync_at then 'success'
            when ls.last_sync_at = ls.last_error_sync_at then 'error'
            else 'unknown'
        end as last_sync_status
    from last_sync ls
),

-- Calculate sync metrics for all time
sync_metrics as (
    select
        connection_name,
        connector_name,
        count(*) as total_syncs,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,
        avg(sync_duration_seconds) as avg_sync_duration_seconds,
        max(sync_duration_seconds) as max_sync_duration_seconds
    from sync_performance
    group by 1, 2
),

-- Calculate recent sync metrics (last 7 days if data exists)
recent_sync_metrics as (
    select
        connection_name,
        connector_name,
        count(*) as total_syncs_last_7d,
        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs_last_7d,
        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,
        case 
            when count(*) > 0 then 
                (sum(case when sync_status = 'success' then 1 else 0 end) / nullif(count(*), 0)) * 100 
            else null 
        end as success_rate_last_7d
    from sync_performance
    where sync_date >= dateadd(day, -7, current_date())
    group by 1, 2
),

-- Combine all metrics
connector_health as (
    select
        ss.connection_name,
        ss.connector_name,
        ss.destination_name,
        ss.last_sync_at,
        ss.last_successful_sync_at,
        ss.last_error_sync_at,
        ss.last_sync_status,
        coalesce(sm.total_syncs, 0) as total_syncs,
        coalesce(sm.successful_syncs, 0) as successful_syncs,
        coalesce(sm.failed_syncs, 0) as failed_syncs,
        sm.avg_sync_duration_seconds,
        sm.max_sync_duration_seconds,
        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,
        coalesce(rsm.successful_syncs_last_7d, 0) as successful_syncs_last_7d,
        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,
        coalesce(rsm.success_rate_last_7d, 
            case 
                when sm.total_syncs > 0 then 
                    (sm.successful_syncs / nullif(sm.total_syncs, 0)) * 100 
                else null 
            end
        ) as success_rate_last_7d
    from sync_status ss
    left join sync_metrics sm on ss.connection_name = sm.connection_name and ss.connector_name = sm.connector_name
    left join recent_sync_metrics rsm on ss.connection_name = rsm.connection_name and ss.connector_name = rsm.connector_name
)

select * from connector_health
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_connector_health"} */
 Succeeded [  1.92s] model fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:20:02.662650 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [3.1s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:20:10.934282 | 019a899a-bd35-71a1-935d-e090b9212987 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:20:11.092862 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:20:11.092892 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:20:11.092898 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:20:11.524837 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [590ms]
==================== 2025-11-15 22:20:32.302595 | 019a899b-10ad-7582-ba5e-cb14a86637b2 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:20:32.459989 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:20:32.460013 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:20:32.460018 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:20:33.293781 [debug]: Query executed on node unknown:
SELECT COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:20:33.294117 [info ]: Connector Health row count: 76
22:20:33.569636 [debug]: Query executed on node unknown:
SELECT * FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health LIMIT 5
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:20:33.570045 [info ]: Sample row: connection=sev_logs, connector=Connector SDK, status=success
22:20:33.570193 [info ]: Sample row: connection=s3demo1.merged, connector=Amazon S3, status=success
22:20:33.570249 [info ]: Sample row: connection=fivetran_log, connector=Fivetran Platform, status=success
22:20:33.570366 [info ]: Sample row: connection=fivetran_log, connector=Fivetran Platform, status=success
22:20:33.570412 [info ]: Sample row: connection=salesforce_sandbox, connector=Salesforce sandbox, status=success
New version available 2.0.0-preview.67 (run `dbt system update`)
22:20:33.600595 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.3s]
==================== 2025-11-15 22:21:09.458099 | 019a899b-a1d1-73f2-bcec-6a0910092ae8 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:21:09.613463 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:21:09.613488 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:21:09.613493 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:21:10.679498 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:21:10.770563 [error]: dbt0227: No column CONNECTION_ID found. Available are INCREMENTAL_MAR.CONNECTION_NAME, INCREMENTAL_MAR.DESTINATION_ID, INCREMENTAL_MAR.SCHEMA_NAME, INCREMENTAL_MAR.SYNC_TYPE, INCREMENTAL_MAR.TABLE_NAME, INCREMENTAL_MAR.UPDATED_AT, INCREMENTAL_MAR._FIVETRAN_SYNCED ..(and 3 more)
  --> models/marts/usage/fct_fivetran_monthly_active_rows.sql:23:9 (target/compiled/models/marts/usage/fct_fivetran_monthly_active_rows.sql:21:9)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:21:10.800484 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [1.3s]
Processed: 1 model
Summary: 1 total | 1 error
==================== 2025-11-15 22:21:19.643340 | 019a899b-c99a-7eb1-a6e8-e7f76bca2dab ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:21:19.800581 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:21:19.800609 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:21:19.800614 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:21:20.171974 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [528ms]
==================== 2025-11-15 22:21:29.740250 | 019a899b-f10b-7e40-b35b-4cb45f5c781b ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:21:29.896369 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:21:29.896394 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:21:29.896399 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:21:31.127183 [debug]: Query executed on node unknown:
SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG'
AND table_name = 'INCREMENTAL_MAR'
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:21:31.127321 [info ]: Columns for INCREMENTAL_MAR:
New version available 2.0.0-preview.67 (run `dbt system update`)
22:21:31.148714 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.4s]
==================== 2025-11-15 22:22:12.965035 | 019a899c-99e4-78d0-97b0-b715068efa28 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:22:13.120155 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:22:13.120182 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:22:13.120186 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:22:14.007613 [debug]: Query executed on node unknown:
show terse schemas in database JASON_CHLETSOS
    limit 10000
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:22:14.594038 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_monthly_active_rows:
SHOW OBJECTS IN SCHEMA "JASON_CHLETSOS"."FIVETRAN_ANALYTICS_FIVETRAN_ANALYTICS" LIMIT 10000
22:22:14.594892 [debug]: Writing runtime sql for node "model.fivetran_analytics.fct_fivetran_monthly_active_rows"
22:22:17.988696 [debug]: Query executed on node model.fivetran_analytics.fct_fivetran_monthly_active_rows:
create or replace transient  table JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
    
    
    
    as (

with incremental_mar as (
    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar
),

connector_details as (
    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details
),

-- Get all months in the data
months as (
    select distinct 
        date_trunc('month', measured_date) as month_date
    from incremental_mar
),

-- Get all connector, schema, table combinations
connector_schema_tables as (
    select distinct
        connection_name,
        schema_name,
        table_name
    from incremental_mar
),

-- Create a cross join of all months and connector/schema/tables
month_connector_combinations as (
    select
        m.month_date,
        cst.connection_name,
        cst.schema_name,
        cst.table_name
    from months m
    cross join connector_schema_tables cst
),

-- Calculate monthly active rows
monthly_active_rows as (
    select
        date_trunc('month', measured_date) as month_date,
        connection_name,
        schema_name,
        table_name,
        sum(incremental_rows) as active_rows,
        sum(case when is_free then incremental_rows else 0 end) as free_active_rows,
        sum(case when not is_free then incremental_rows else 0 end) as paid_active_rows
    from incremental_mar
    group by 1, 2, 3, 4
),

-- Join with connector details
enriched_monthly_active_rows as (
    select
        mcc.month_date,
        mcc.connection_name,
        cd.connector_name,
        mcc.schema_name,
        mcc.table_name,
        coalesce(mar.free_active_rows, 0) as free_active_rows,
        coalesce(mar.paid_active_rows, 0) as paid_active_rows,
        coalesce(mar.active_rows, 0) as total_active_rows
    from month_connector_combinations mcc
    left join monthly_active_rows mar 
        on mcc.month_date = mar.month_date
        and mcc.connection_name = mar.connection_name
        and mcc.schema_name = mar.schema_name
        and mcc.table_name = mar.table_name
    left join connector_details cd 
        on mcc.connection_name = cd.connection_name
)

select * from enriched_monthly_active_rows
order by month_date desc, total_active_rows desc
    )

/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","node_id":"model.fivetran_analytics.fct_fivetran_monthly_active_rows"} */
 Succeeded [  3.76s] model fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows (table)
New version available 2.0.0-preview.67 (run `dbt system update`)
22:22:18.033800 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings for target 'dev' [5.1s]
Processed: 1 model
Summary: 1 total | 1 success
==================== 2025-11-15 22:42:24.384486 | 019a89af-15f7-7233-bb63-d44f093cce41 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:42:24.596227 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:42:24.596442 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:42:24.596448 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
New version available 2.0.0-preview.67 (run `dbt system update`)
22:42:25.586982 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.2s]
==================== 2025-11-15 22:42:46.897543 | 019a89af-6df0-7df1-aaa6-d925dbe4bfb1 ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:42:47.058389 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:42:47.058419 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:42:47.058425 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:42:48.026872 [debug]: Query executed on node unknown:
SELECT COUNT(*) as row_count FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:42:48.027397 [info ]: Monthly Active Rows row count: 1299780
22:42:48.540329 [debug]: Query executed on node unknown:
SELECT * FROM JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows LIMIT 5
/* {"app":"dbt","dbt_version":"2.0.0","profile_name":"default","target_name":"dev","connection_name":""} */
22:42:48.540648 [info ]: Sample row: month=2025-11-01, connection=mdls_sap_test, schema=mdls_sap_test_saphanadb, table=doktl, rows=82754230
22:42:48.540694 [info ]: Sample row: month=2025-11-01, connection=mdls_sap_test, schema=mdls_sap_test_saphanadb, table=doktl, rows=82754230
22:42:48.540716 [info ]: Sample row: month=2025-11-01, connection=oracle_fusion_to_azure, schema=oracle_fusion_to_azure_finextract_xlabiccextract, table=subledger_journal_distribution_extract_pvo, rows=29219605
22:42:48.540732 [info ]: Sample row: month=2025-11-01, connection=oracle_prod, schema=oracle_prod_finextract_xlabiccextract, table=subledger_journal_distribution_extract_pvo, rows=29219163
22:42:48.540748 [info ]: Sample row: month=2025-11-01, connection=oracle_fusion_to_azure, schema=oracle_fusion_to_azure_finxlajrnlenterjrnl, table=subledger_journal_distribution_pvo, rows=28816644
New version available 2.0.0-preview.67 (run `dbt system update`)
22:42:48.575614 [info ]: 
==================== Execution Summary =====================
Finished 'run-operation' with 3 warnings for target 'dev' [1.7s]
==================== 2025-11-15 22:57:51.341703 | 019a89bd-3ae5-74d3-a6eb-fcb6c462291a ====================
dbt-fusion 2.0.0-preview.63
   Loading profiles.yml
22:57:51.569655 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_destination_security'
  --> models/marts/governance/governance_models.yml
22:57:51.569726 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_monthly_credits'
  --> models/marts/usage/usage_models.yml
22:57:51.569733 [warn ]: dbt1005: Unused schema.yml entry for model 'fct_fivetran_schema_changes'
  --> models/marts/monitoring/monitoring_models.yml
22:57:51.574336 [error]: dbt1005: Found duplicate model 'fct_fivetran_connector_recommendations'
  --> models/marts/usage/fct_fivetran_connector_recommendations.sql
New version available 2.0.0-preview.67 (run `dbt system update`)
22:57:52.056643 [info ]: 
==================== Execution Summary =====================
Finished 'run' with 3 warnings and 1 error for target 'dev' [714ms]
[0m18:34:19.979249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d3e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d3e0f0>]}


============================== 18:34:19.982301 | 53619cfb-ae64-4433-883f-4dc0da4faabf ==============================
[0m18:34:19.982301 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:34:19.982550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jason.chletsos/Documents/GitHub/dbt-nao-testing', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jason.chletsos/Documents/GitHub/dbt-nao-testing/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:19.987357 [info ] [MainThread]: dbt version: 1.9.0
[0m18:34:19.987540 [info ] [MainThread]: python version: 3.12.11
[0m18:34:19.987656 [info ] [MainThread]: python path: /Users/jason.chletsos/.pyenv/versions/3.12.11/bin/python
[0m18:34:19.987763 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit
[0m18:34:20.327145 [info ] [MainThread]: Using profiles dir at /Users/jason.chletsos/Documents/GitHub/dbt-nao-testing
[0m18:34:20.327403 [info ] [MainThread]: Using profiles.yml file at /Users/jason.chletsos/Documents/GitHub/dbt-nao-testing/profiles.yml
[0m18:34:20.327525 [info ] [MainThread]: Using dbt_project.yml file at /Users/jason.chletsos/Documents/GitHub/dbt-nao-testing/dbt_project.yml
[0m18:34:20.327758 [info ] [MainThread]: adapter type: snowflake
[0m18:34:20.327867 [info ] [MainThread]: adapter version: 1.9.0
[0m18:34:20.362730 [info ] [MainThread]: Configuration:
[0m18:34:20.362980 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:34:20.363102 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:34:20.363210 [info ] [MainThread]: Required dependencies:
[0m18:34:20.363397 [debug] [MainThread]: Executing "git --help"
[0m18:34:20.387969 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:34:20.388354 [debug] [MainThread]: STDERR: "b''"
[0m18:34:20.388502 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:34:20.388637 [info ] [MainThread]: Connection:
[0m18:34:20.388795 [info ] [MainThread]:   account: a3209653506471-sales-eng-demo
[0m18:34:20.388902 [info ] [MainThread]:   user: jason.chletsos@fivetran.com
[0m18:34:20.389015 [info ] [MainThread]:   database: JASON_CHLETSOS
[0m18:34:20.389114 [info ] [MainThread]:   warehouse: DEFAULT
[0m18:34:20.389228 [info ] [MainThread]:   role: SALES_DEMO_ROLE
[0m18:34:20.389330 [info ] [MainThread]:   schema: fivetran_analytics
[0m18:34:20.389450 [info ] [MainThread]:   authenticator: None
[0m18:34:20.389552 [info ] [MainThread]:   oauth_client_id: None
[0m18:34:20.389651 [info ] [MainThread]:   query_tag: dbt-fivetran-analytics
[0m18:34:20.389753 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:34:20.389858 [info ] [MainThread]:   host: None
[0m18:34:20.389953 [info ] [MainThread]:   port: None
[0m18:34:20.390064 [info ] [MainThread]:   proxy_host: None
[0m18:34:20.390161 [info ] [MainThread]:   proxy_port: None
[0m18:34:20.390262 [info ] [MainThread]:   protocol: None
[0m18:34:20.390364 [info ] [MainThread]:   connect_retries: 1
[0m18:34:20.390463 [info ] [MainThread]:   connect_timeout: None
[0m18:34:20.390563 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:34:20.390658 [info ] [MainThread]:   retry_all: False
[0m18:34:20.390755 [info ] [MainThread]:   insecure_mode: False
[0m18:34:20.390858 [info ] [MainThread]:   reuse_connections: True
[0m18:34:20.391166 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:34:20.447551 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:34:20.479766 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:34:20.479948 [debug] [MainThread]: On debug: select 1 as id
[0m18:34:20.480050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:23.464275 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.984 seconds
[0m18:34:23.465572 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:34:23.465956 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:34:23.595757 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.6548438, "process_in_blocks": "0", "process_kernel_time": 0.237031, "process_mem_max_rss": "221233152", "process_out_blocks": "0", "process_user_time": 1.163122}
[0m18:34:23.596484 [debug] [MainThread]: Command `dbt debug` succeeded at 18:34:23.596331 after 3.66 seconds
[0m18:34:23.596882 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:34:23.597212 [debug] [MainThread]: On debug: Close
[0m18:34:23.729792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110457ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12407b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247350a0>]}
[0m18:34:23.730592 [debug] [MainThread]: Flushing usage events
[0m18:34:23.887037 [debug] [MainThread]: An error was encountered while trying to flush usage events
