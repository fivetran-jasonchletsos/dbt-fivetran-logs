{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-11-16T01:42:26.590083Z", "invocation_id": "1c893981-e74b-46d2-9d94-97d510c30f5e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.436684Z", "completed_at": "2025-11-16T01:42:16.441304Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.442135Z", "completed_at": "2025-11-16T01:42:16.790789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3624439239501953, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d1e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__connection", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connection\n),\n\nrenamed as (\n    select\n        connection_id,\n        connection_name,\n        connector_type_id,\n        destination_id,\n        connecting_user_id,\n        signed_up as created_at,\n        paused as is_paused,\n        sync_frequency,\n        deployment_type,\n        _fivetran_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.429845Z", "completed_at": "2025-11-16T01:42:16.441947Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.461531Z", "completed_at": "2025-11-16T01:42:16.823140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39531540870666504, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d22"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__account", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.account\n),\n\nrenamed as (\n    select\n        id as account_id,\n        name as account_name,\n        created_at,\n        status as account_status,\n        country,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__account", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.435051Z", "completed_at": "2025-11-16T01:42:16.441522Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.453962Z", "completed_at": "2025-11-16T01:42:16.875446Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.44731712341308594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d362"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__audit_trail", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.audit_trail\n),\n\nrenamed as (\n    select\n        id as audit_id,\n        user_id,\n        captured_at as event_created_at,\n        action as event_type,\n        interaction_method,\n        primary_resource_type as resource_type,\n        primary_resource_id as resource_id,\n        secondary_resource_type,\n        secondary_resource_id,\n        old_values,\n        new_values,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__audit_trail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.793863Z", "completed_at": "2025-11-16T01:42:16.795866Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.796075Z", "completed_at": "2025-11-16T01:42:17.050182Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2568328380584717, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d366"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination\n),\n\nrenamed as (\n    select\n        id as destination_id,\n        name as destination_name,\n        account_id,\n        created_at,\n        region,\n        is_active,\n        deployment_type,\n        destination_type,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.825444Z", "completed_at": "2025-11-16T01:42:16.827447Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.827636Z", "completed_at": "2025-11-16T01:42:17.125981Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30118489265441895, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d36a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_column_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_column_change_event\n),\n\nrenamed as (\n    select\n        column_id as destination_column_id,\n        destination_id,\n        connection_id,\n        attribute_name,\n        change_type,\n        new_value,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_column_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.876982Z", "completed_at": "2025-11-16T01:42:16.878519Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.878656Z", "completed_at": "2025-11-16T01:42:17.181359Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.30473971366882324, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409bfa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__incremental_mar", "compiled": true, "compiled_code": "with source as (\n\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.incremental_mar\n\n),\n\nrenamed as (\n\n    select\n        connection_name,\n        destination_id,\n        measured_date,\n        schema_name,\n        table_name,\n        sync_type,\n        incremental_rows,\n        case \n            when free_type = 'FREE' then true \n            when free_type = 'PAID' then false \n            else null \n        end as is_free,\n        updated_at,\n        _fivetran_synced\n    from source\n\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.052687Z", "completed_at": "2025-11-16T01:42:17.055015Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.055218Z", "completed_at": "2025-11-16T01:42:17.279430Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22732973098754883, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409bfe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__log", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.log\n),\n\nrenamed as (\n    select\n        id as log_id,\n        sync_id,\n        time_stamp as logged_at,\n        event as event_type,\n        connection_id,\n        message_event as message_type,\n        message_data as message_content,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.128668Z", "completed_at": "2025-11-16T01:42:17.131464Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.131817Z", "completed_at": "2025-11-16T01:42:17.348108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22014427185058594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c02"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__transformation_runs", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.transformation_runs\n),\n\nrenamed as (\n    select\n        destination_id,\n        job_id,\n        measured_date,\n        project_type,\n        case \n            when free_type = 'free' then true\n            else false\n        end as is_free,\n        job_name,\n        updated_at,\n        model_runs,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.184170Z", "completed_at": "2025-11-16T01:42:17.186789Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.187045Z", "completed_at": "2025-11-16T01:42:17.478489Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.29495811462402344, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e2fa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__user", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.user\n),\n\nrenamed as (\n    select\n        id as user_id,\n        email,\n        given_name as first_name,\n        family_name as last_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.282464Z", "completed_at": "2025-11-16T01:42:17.293068Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.293317Z", "completed_at": "2025-11-16T01:42:17.601250Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.31967997550964355, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e2fe"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__connection_connection_id.b7326add64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect connection_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\nwhere connection_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.350397Z", "completed_at": "2025-11-16T01:42:17.354760Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.354968Z", "completed_at": "2025-11-16T01:42:17.614663Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2648332118988037, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e306"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__connection_connection_id.5ec876e7d8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    connection_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\nwhere connection_id is not null\ngroup by connection_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.603841Z", "completed_at": "2025-11-16T01:42:17.608065Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.608308Z", "completed_at": "2025-11-16T01:42:18.151853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5486931800842285, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fae"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__account_account_id.3de58e95dc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    account_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__account\nwhere account_id is not null\ngroup by account_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.481600Z", "completed_at": "2025-11-16T01:42:17.485741Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.485997Z", "completed_at": "2025-11-16T01:42:18.152812Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6719639301300049, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fa6"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__account_account_id.19a03e662a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__account\nwhere account_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:17.617060Z", "completed_at": "2025-11-16T01:42:17.619859Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:17.620061Z", "completed_at": "2025-11-16T01:42:18.190387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5739421844482422, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405faa"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__audit_trail_audit_id.6ced6438b4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect audit_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__audit_trail\nwhere audit_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.155263Z", "completed_at": "2025-11-16T01:42:18.161049Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.161572Z", "completed_at": "2025-11-16T01:42:18.339751Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.18519210815429688, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d2a"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__audit_trail_audit_id.781d7e9f25", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    audit_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__audit_trail\nwhere audit_id is not null\ngroup by audit_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.157949Z", "completed_at": "2025-11-16T01:42:18.161324Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.162912Z", "completed_at": "2025-11-16T01:42:18.341562Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.18678998947143555, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d26"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\nwhere destination_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.191754Z", "completed_at": "2025-11-16T01:42:18.193883Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.194043Z", "completed_at": "2025-11-16T01:42:18.356946Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1655871868133545, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d2e"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    destination_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\nwhere destination_id is not null\ngroup by destination_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.361147Z", "completed_at": "2025-11-16T01:42:18.363932Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.364121Z", "completed_at": "2025-11-16T01:42:18.506572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14610028266906738, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d36e"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__log_log_id.6b85ed66dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect log_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\nwhere log_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.345278Z", "completed_at": "2025-11-16T01:42:18.350591Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.351038Z", "completed_at": "2025-11-16T01:42:18.612151Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.26799893379211426, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d372"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__destination_column_change_event_destination_column_id.90a12e1d7f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_column_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_column_change_event\nwhere destination_column_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.348455Z", "completed_at": "2025-11-16T01:42:18.350819Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.353862Z", "completed_at": "2025-11-16T01:42:18.625200Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2807180881500244, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d376"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__daily_active_rows", "compiled": true, "compiled_code": "with incremental_mar as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar\n),\n\n-- Aggregate to daily level\ndaily_active_rows as (\n    select\n        measured_date as date_day,\n        connection_name,\n        destination_id,\n        schema_name,\n        table_name,\n        is_free,\n        sum(incremental_rows) as active_rows\n    from incremental_mar\n    group by 1, 2, 3, 4, 5, 6\n)\n\nselect * from daily_active_rows", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.509714Z", "completed_at": "2025-11-16T01:42:18.513841Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.514111Z", "completed_at": "2025-11-16T01:42:18.934877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42614030838012695, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c06"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__user_user_id.cf0cc5540a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.626796Z", "completed_at": "2025-11-16T01:42:18.628564Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.628729Z", "completed_at": "2025-11-16T01:42:18.940736Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3143422603607178, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__daily_api_calls", "compiled": true, "compiled_code": "with logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnections as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n),\n\n-- Filter to API call events\napi_calls as (\n    select\n        connection_id,\n        date_trunc('day', logged_at) as date_day,\n        count(*) as api_calls_count\n    from logs\n    where event_type = 'api_call'\n    group by 1, 2\n),\n\n-- Join with connection information\nenriched_api_calls as (\n    select\n        a.date_day,\n        a.connection_id,\n        c.connection_name,\n        c.destination_id,\n        a.api_calls_count\n    from api_calls a\n    left join connections c on a.connection_id = c.connection_id\n)\n\nselect * from enriched_api_calls", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:18.613718Z", "completed_at": "2025-11-16T01:42:18.616542Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:18.616736Z", "completed_at": "2025-11-16T01:42:18.996241Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.38301992416381836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c0a"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__user_user_id.25561a7dda", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:16.438248Z", "completed_at": "2025-11-16T01:42:16.441710Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:16.460234Z", "completed_at": "2025-11-16T01:42:19.167944Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.7393887042999268, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fb2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__connector_type", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connector_type\n),\n\nrenamed as (\n    select\n        id as connector_type_id,\n        official_connector_name as connector_name,\n        type as connector_type,\n        availability as availability_status,\n        created_at,\n        public_beta_at,\n        release_at as released_at,\n        deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.171724Z", "completed_at": "2025-11-16T01:42:19.176157Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.177345Z", "completed_at": "2025-11-16T01:42:19.397273Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22654414176940918, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e30a"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_stg_fivetran_log__connector_type_connector_type_id.36b0f6c89a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect connector_type_id\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\nwhere connector_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.174107Z", "completed_at": "2025-11-16T01:42:19.175957Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.176307Z", "completed_at": "2025-11-16T01:42:19.432754Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.26168203353881836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e30e"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_stg_fivetran_log__connector_type_connector_type_id.4b3222f41d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    connector_type_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\nwhere connector_type_id is not null\ngroup by connector_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.437534Z", "completed_at": "2025-11-16T01:42:19.444405Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.445023Z", "completed_at": "2025-11-16T01:42:19.805919Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3697850704193115, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d32"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__connector_details", "compiled": true, "compiled_code": "with connections as (\n    \n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n\n),\n\ndestinations as (\n\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\n\n),\n\nconnector_types as (\n\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\n\n),\n\nconnector_details as (\n\n    select\n        connections.connection_id,\n        connections.connection_name,\n        connections.connector_type_id,\n        connector_types.connector_name,\n        connections.created_at as connection_created_at,\n        connections.destination_id,\n        destinations.destination_name,\n        connections.is_paused\n    from connections\n    left join destinations \n        on connections.destination_id = destinations.destination_id\n    left join connector_types \n        on connections.connector_type_id = connector_types.connector_type_id\n\n)\n\nselect * from connector_details", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.441004Z", "completed_at": "2025-11-16T01:42:19.444754Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.446846Z", "completed_at": "2025-11-16T01:42:19.947067Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5105040073394775, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e312"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__sync_events", "compiled": true, "compiled_code": "with logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnections as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n),\n\ndestinations as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\n),\n\nconnector_types as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\n),\n\n-- Extract sync information from message content\nsync_logs as (\n    select\n        log_id,\n        sync_id,\n        connection_id,\n        logged_at as sync_time,\n        message_content,\n        event_type,\n        case \n            when event_type = 'SEVERE' then 'error'\n            when event_type = 'WARNING' then 'warning'\n            else 'info'\n        end as sync_status,\n        case\n            when message_content like '%rows synced%' then\n                try_cast(regexp_substr(message_content, '[0-9]+') as integer)\n            else null\n        end as rows_synced\n    from logs\n    where message_content like '%sync%' \n       or message_content like '%Sync%'\n       or message_content like '%rows synced%'\n),\n\n-- Group by connection to get sync metrics\nconnection_syncs as (\n    select\n        connection_id,\n        min(sync_time) as first_sync_time,\n        max(sync_time) as last_sync_time,\n        count(*) as sync_count,\n        sum(case when sync_status = 'error' then 1 else 0 end) as error_count,\n        sum(coalesce(rows_synced, 0)) as total_rows_synced\n    from sync_logs\n    group by 1\n),\n\n-- Join with connection and destination information\ncombined_syncs as (\n    select\n        cs.connection_id,\n        c.connection_name,\n        ct.connector_name,\n        cs.first_sync_time,\n        cs.last_sync_time,\n        cs.sync_count,\n        cs.error_count,\n        cs.total_rows_synced,\n        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,\n        c.destination_id,\n        d.destination_name\n    from connection_syncs cs\n    left join connections c on cs.connection_id = c.connection_id\n    left join destinations d on c.destination_id = d.destination_id\n    left join connector_types ct on c.connector_type_id = ct.connector_type_id\n)\n\nselect * from combined_syncs", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.811020Z", "completed_at": "2025-11-16T01:42:19.818392Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.818955Z", "completed_at": "2025-11-16T01:42:20.221586Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.41198182106018066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fbe"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.not_null_int_fivetran_log__connector_details_connection_id.2ba7467ab8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect connection_id\nfrom JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\nwhere connection_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:19.814807Z", "completed_at": "2025-11-16T01:42:19.818683Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:19.820536Z", "completed_at": "2025-11-16T01:42:20.433545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6234688758850098, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fba"}, "message": null, "failures": 0, "unique_id": "test.dbt_fivetran_logs.unique_int_fivetran_log__connector_details_connection_id.62196ac8a6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    connection_id as unique_field,\n    count(*) as n_records\n\nfrom JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\nwhere connection_id is not null\ngroup by connection_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:20.440627Z", "completed_at": "2025-11-16T01:42:20.450650Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:20.458540Z", "completed_at": "2025-11-16T01:42:21.270488Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8339488506317139, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d36"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_schema_change_history", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract schema change events from logs\nschema_change_events as (\n    select\n        log_id,\n        logged_at as change_detected_at,\n        connection_id,\n        message_type,\n        message_content,\n        -- Extract schema and table information from message content\n        regexp_substr(message_content, 'schema ([^\\\\s]+)', 1, 1, 'e') as schema_name,\n        regexp_substr(message_content, 'table ([^\\\\s\\\\.]+)', 1, 1, 'e') as table_name,\n        -- Determine change type\n        case\n            when message_type like '%column_added%' then 'Column Added'\n            when message_type like '%column_removed%' then 'Column Removed'\n            when message_type like '%column_renamed%' then 'Column Renamed'\n            when message_type like '%column_type_changed%' then 'Column Type Changed'\n            when message_type like '%table_added%' then 'Table Added'\n            when message_type like '%table_removed%' then 'Table Removed'\n            when message_type like '%table_renamed%' then 'Table Renamed'\n            when message_type like '%schema_added%' then 'Schema Added'\n            when message_type like '%schema_removed%' then 'Schema Removed'\n            when message_type like '%schema_renamed%' then 'Schema Renamed'\n            else 'Other Schema Change'\n        end as change_type,\n        -- Extract column information\n        regexp_substr(message_content, 'column ([^\\\\s]+)', 1, 1, 'e') as column_name,\n        -- Extract data type information for type changes\n        case \n            when message_type like '%column_type_changed%' then \n                regexp_substr(message_content, 'from ([^\\\\s]+) to', 1, 1, 'e')\n            else null\n        end as previous_data_type,\n        case \n            when message_type like '%column_type_changed%' then \n                regexp_substr(message_content, 'to ([^\\\\s\\\\.]+)', 1, 1, 'e')\n            else null\n        end as new_data_type\n    from logs\n    where event_type = 'schema_change'\n),\n\n-- Enrich with connector information\nenriched_schema_changes as (\n    select\n        sce.change_detected_at,\n        cd.connection_name,\n        cd.connector_name,\n        sce.schema_name,\n        sce.table_name,\n        sce.change_type,\n        sce.column_name,\n        sce.previous_data_type,\n        sce.new_data_type\n    from schema_change_events sce\n    left join connector_details cd on sce.connection_id = cd.connection_id\n    where sce.schema_name is not null\n)\n\nselect * from enriched_schema_changes\norder by change_detected_at desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_schema_change_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:20.437387Z", "completed_at": "2025-11-16T01:42:20.444027Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:20.455318Z", "completed_at": "2025-11-16T01:42:21.378211Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9423060417175293, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d37a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_daily_api_usage", "compiled": true, "compiled_code": "with daily_api_calls as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Enrich with connector and destination information\nenriched_api_calls as (\n    select\n        dac.date_day,\n        dac.connection_id,\n        dac.connection_name,\n        cd.connector_name,\n        cd.destination_name,\n        dac.api_calls_count\n    from daily_api_calls dac\n    left join connector_details cd on dac.connection_id = cd.connection_id\n)\n\nselect * from enriched_api_calls", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_daily_api_usage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:21.273931Z", "completed_at": "2025-11-16T01:42:21.278531Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:21.278822Z", "completed_at": "2025-11-16T01:42:22.029466Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7563807964324951, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d37e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_user_activity", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nusers as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract user activity events from logs\nuser_activity_events as (\n    select\n        logged_at,\n        connection_id,\n        event_type,\n        message_type,\n        message_content\n    from logs\n    where event_type in ('user_action', 'account_modification', 'setup')\n),\n\n-- Categorize user actions\ncategorized_actions as (\n    select\n        date_trunc('day', logged_at) as activity_date,\n        connection_id,\n        -- Determine action type\n        case\n            when message_type like '%create%' then 'Create'\n            when message_type like '%update%' then 'Update'\n            when message_type like '%delete%' then 'Delete'\n            when message_type like '%enable%' then 'Enable'\n            when message_type like '%disable%' then 'Disable'\n            when message_type like '%pause%' then 'Pause'\n            when message_type like '%resume%' then 'Resume'\n            when message_type like '%sync%' then 'Sync'\n            when message_type like '%login%' then 'Login'\n            else 'Other'\n        end as action_type,\n        -- Determine resource type\n        case\n            when message_type like '%connection%' then 'Connection'\n            when message_type like '%destination%' then 'Destination'\n            when message_type like '%schema%' then 'Schema'\n            when message_type like '%table%' then 'Table'\n            when message_type like '%user%' then 'User'\n            when message_type like '%account%' then 'Account'\n            else 'Other'\n        end as resource_type,\n        -- Extract user information if available\n        regexp_substr(message_content, 'by user ([^\\\\s]+)', 1, 1, 'e') as user_email,\n        -- Extract resource name if available\n        case\n            when message_type like '%connection%' then \n                regexp_substr(message_content, 'connection ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%destination%' then \n                regexp_substr(message_content, 'destination ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%schema%' then \n                regexp_substr(message_content, 'schema ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%table%' then \n                regexp_substr(message_content, 'table ([^\\\\s]+)', 1, 1, 'e')\n            else null\n        end as resource_name,\n        count(*) as activity_count\n    from user_activity_events\n    group by 1, 2, 3, 4, 5, 6\n),\n\n-- Enrich with user and connection information\nenriched_user_activity as (\n    select\n        ca.activity_date,\n        coalesce(u.user_id, 'unknown') as user_id,\n        coalesce(ca.user_email, u.email, 'unknown') as user_email,\n        concat(coalesce(u.first_name, ''), ' ', coalesce(u.last_name, '')) as user_name,\n        ca.action_type,\n        ca.resource_type,\n        coalesce(ca.resource_name, cd.connection_name, 'unknown') as resource_name,\n        ca.activity_count\n    from categorized_actions ca\n    left join users u on ca.user_email = u.email\n    left join connector_details cd on ca.connection_id = cd.connection_id\n)\n\nselect * from enriched_user_activity\norder by activity_date desc, user_email, action_type", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_user_activity", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:20.442107Z", "completed_at": "2025-11-16T01:42:20.443857Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:20.444383Z", "completed_at": "2025-11-16T01:42:22.300051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8632628917694092, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d3a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_sync_performance", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract detailed sync information from logs\ndetailed_syncs as (\n    select\n        l.log_id,\n        l.sync_id,\n        l.connection_id,\n        l.logged_at as sync_time,\n        cd.connection_name,\n        cd.connector_name,\n        cd.destination_name,\n        date(l.logged_at) as sync_date,\n        l.event_type,\n        l.message_content,\n        case \n            when l.event_type = 'SEVERE' then 'error'\n            when l.event_type = 'WARNING' then 'warning'\n            else 'success'\n        end as sync_status,\n        case\n            when l.message_content like '%rows synced%' then\n                try_cast(regexp_substr(l.message_content, '[0-9]+') as integer)\n            else null\n        end as rows_synced\n    from logs l\n    join connector_details cd on l.connection_id = cd.connection_id\n    where l.message_content like '%sync%' \n       or l.message_content like '%Sync%'\n       or l.message_content like '%rows synced%'\n),\n\n-- Group syncs by ID to get metrics\nsync_metrics as (\n    select\n        sync_id,\n        connection_id,\n        connection_name,\n        connector_name,\n        destination_name,\n        min(sync_time) as sync_start_time,\n        max(sync_time) as sync_end_time,\n        date(min(sync_time)) as sync_date,\n        max(case when sync_status = 'error' then 1 else 0 end) > 0 as has_errors,\n        max(rows_synced) as rows_synced\n    from detailed_syncs\n    where sync_id is not null\n    group by 1, 2, 3, 4, 5\n),\n\n-- Calculate final metrics\nfinal_syncs as (\n    select\n        sync_id,\n        connection_id,\n        connection_name,\n        connector_name,\n        destination_name,\n        sync_start_time,\n        sync_end_time,\n        sync_date,\n        case when has_errors then 'error' else 'success' end as sync_status,\n        datediff(second, sync_start_time, sync_end_time) as sync_duration_seconds,\n        coalesce(rows_synced, 0) as rows_synced\n    from sync_metrics\n)\n\nselect * from final_syncs", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:22.312997Z", "completed_at": "2025-11-16T01:42:22.315636Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:22.316488Z", "completed_at": "2025-11-16T01:42:23.481768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.176314115524292, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1a04-0003-03521540d382"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_sync_performance_trends", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance\n),\n\n-- Calculate daily sync metrics\ndaily_sync_metrics as (\n    select\n        sync_date,\n        connection_name,\n        connector_name,\n        count(*) as sync_count,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,\n        avg(sync_duration_seconds) as avg_sync_duration,\n        max(sync_duration_seconds) as max_sync_duration,\n        min(sync_duration_seconds) as min_sync_duration,\n        sum(rows_synced) as total_rows_synced\n    from sync_performance\n    where sync_date >= dateadd(day, -90, current_date())\n    group by 1, 2, 3\n),\n\n-- Calculate rolling averages\nrolling_metrics as (\n    select\n        sync_date,\n        connection_name,\n        connector_name,\n        sync_count,\n        successful_syncs,\n        failed_syncs,\n        avg_sync_duration,\n        max_sync_duration,\n        min_sync_duration,\n        total_rows_synced,\n        -- Calculate 7-day rolling averages\n        avg(avg_sync_duration) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_avg_duration,\n        avg(total_rows_synced) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_avg_rows,\n        -- Calculate success rate\n        (successful_syncs / nullif(sync_count, 0)) * 100 as success_rate,\n        -- Calculate 7-day rolling success rate\n        avg((successful_syncs / nullif(sync_count, 0)) * 100) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_success_rate\n    from daily_sync_metrics\n)\n\nselect * from rolling_metrics\norder by sync_date desc, connection_name, connector_name", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance_trends", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:22.306300Z", "completed_at": "2025-11-16T01:42:22.316055Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:22.318241Z", "completed_at": "2025-11-16T01:42:23.555626Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.251528263092041, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c16"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_connector_health", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance\n),\n\n-- Calculate last sync information\nlast_sync as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        max(sync_end_time) as last_sync_at,\n        max(case when sync_status = 'success' then sync_end_time else null end) as last_successful_sync_at,\n        max(case when sync_status = 'error' then sync_end_time else null end) as last_error_sync_at\n    from sync_performance\n    group by 1, 2, 3\n),\n\n-- Calculate sync status\nsync_status as (\n    select\n        ls.connection_name,\n        ls.connector_name,\n        ls.destination_name,\n        ls.last_sync_at,\n        ls.last_successful_sync_at,\n        ls.last_error_sync_at,\n        case\n            when ls.last_sync_at = ls.last_successful_sync_at then 'success'\n            when ls.last_sync_at = ls.last_error_sync_at then 'error'\n            else 'unknown'\n        end as last_sync_status\n    from last_sync ls\n),\n\n-- Calculate sync metrics for all time\nsync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as total_syncs,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,\n        avg(sync_duration_seconds) as avg_sync_duration_seconds,\n        max(sync_duration_seconds) as max_sync_duration_seconds\n    from sync_performance\n    group by 1, 2\n),\n\n-- Calculate recent sync metrics (last 7 days if data exists)\nrecent_sync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as total_syncs_last_7d,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs_last_7d,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,\n        case \n            when count(*) > 0 then \n                (sum(case when sync_status = 'success' then 1 else 0 end) / nullif(count(*), 0)) * 100 \n            else null \n        end as success_rate_last_7d\n    from sync_performance\n    where sync_date >= dateadd(day, -7, current_date())\n    group by 1, 2\n),\n\n-- Combine all metrics\nconnector_health as (\n    select\n        ss.connection_name,\n        ss.connector_name,\n        ss.destination_name,\n        ss.last_sync_at,\n        ss.last_successful_sync_at,\n        ss.last_error_sync_at,\n        ss.last_sync_status,\n        coalesce(sm.total_syncs, 0) as total_syncs,\n        coalesce(sm.successful_syncs, 0) as successful_syncs,\n        coalesce(sm.failed_syncs, 0) as failed_syncs,\n        sm.avg_sync_duration_seconds,\n        sm.max_sync_duration_seconds,\n        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,\n        coalesce(rsm.successful_syncs_last_7d, 0) as successful_syncs_last_7d,\n        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,\n        coalesce(rsm.success_rate_last_7d, \n            case \n                when sm.total_syncs > 0 then \n                    (sm.successful_syncs / nullif(sm.total_syncs, 0)) * 100 \n                else null \n            end\n        ) as success_rate_last_7d\n    from sync_status ss\n    left join sync_metrics sm on ss.connection_name = sm.connection_name and ss.connector_name = sm.connector_name\n    left join recent_sync_metrics rsm on ss.connection_name = rsm.connection_name and ss.connector_name = rsm.connector_name\n)\n\nselect * from connector_health", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:20.439058Z", "completed_at": "2025-11-16T01:42:20.444224Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:20.457477Z", "completed_at": "2025-11-16T01:42:24.091369Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.6550440788269043, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1c12-0003-035215405fc2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_monthly_active_rows", "compiled": true, "compiled_code": "\n\nwith incremental_mar as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Get all months in the data\nmonths as (\n    select distinct \n        date_trunc('month', measured_date) as month_date\n    from incremental_mar\n),\n\n-- Get all connector, schema, table combinations\nconnector_schema_tables as (\n    select distinct\n        connection_name,\n        schema_name,\n        table_name\n    from incremental_mar\n),\n\n-- Create a cross join of all months and connector/schema/tables\nmonth_connector_combinations as (\n    select\n        m.month_date,\n        cst.connection_name,\n        cst.schema_name,\n        cst.table_name\n    from months m\n    cross join connector_schema_tables cst\n),\n\n-- Calculate monthly active rows\nmonthly_active_rows as (\n    select\n        date_trunc('month', measured_date) as month_date,\n        connection_name,\n        schema_name,\n        table_name,\n        sum(incremental_rows) as active_rows,\n        sum(case when is_free then incremental_rows else 0 end) as free_active_rows,\n        sum(case when not is_free then incremental_rows else 0 end) as paid_active_rows\n    from incremental_mar\n    group by 1, 2, 3, 4\n),\n\n-- Join with connector details\nenriched_monthly_active_rows as (\n    select\n        mcc.month_date,\n        mcc.connection_name,\n        cd.connector_name,\n        mcc.schema_name,\n        mcc.table_name,\n        coalesce(mar.free_active_rows, 0) as free_active_rows,\n        coalesce(mar.paid_active_rows, 0) as paid_active_rows,\n        coalesce(mar.active_rows, 0) as total_active_rows\n    from month_connector_combinations mcc\n    left join monthly_active_rows mar \n        on mcc.month_date = mar.month_date\n        and mcc.connection_name = mar.connection_name\n        and mcc.schema_name = mar.schema_name\n        and mcc.table_name = mar.table_name\n    left join connector_details cd \n        on mcc.connection_name = cd.connection_name\n)\n\nselect * from enriched_monthly_active_rows\norder by month_date desc, total_active_rows desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:22.310170Z", "completed_at": "2025-11-16T01:42:22.316283Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:22.319841Z", "completed_at": "2025-11-16T01:42:24.482505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.177509069442749, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c12"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_error_monitoring", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance\n    -- Remove date filter to include all data\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Get error logs\nerror_logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n    where event_type = 'error'\n),\n\n-- Get failed syncs\nfailed_syncs as (\n    select\n        sync_id,\n        connection_name,\n        connector_name,\n        sync_start_time,\n        sync_end_time,\n        sync_date,\n        rows_synced\n    from sync_performance\n    where sync_status = 'error'\n),\n\n-- Create simple error types based on sync failures\nsync_errors as (\n    select\n        fs.sync_id,\n        fs.connection_name,\n        fs.connector_name,\n        fs.sync_start_time,\n        fs.sync_end_time,\n        fs.sync_date,\n        fs.rows_synced,\n        'Sync Failure' as error_message,\n        'Sync Error' as error_type\n    from failed_syncs fs\n),\n\n-- Identify recurring errors\nrecurring_errors as (\n    select\n        connection_name,\n        connector_name,\n        error_type,\n        count(*) as occurrence_count\n    from sync_errors\n    group by 1, 2, 3\n    having count(*) > 1\n),\n\n-- Flag recurring errors\nflagged_errors as (\n    select\n        se.*,\n        case when re.connection_name is not null then true else false end as is_recurring_error,\n        coalesce(re.occurrence_count, 1) as error_occurrence_count\n    from sync_errors se\n    left join recurring_errors re \n        on se.connection_name = re.connection_name\n        and se.connector_name = re.connector_name\n        and se.error_type = re.error_type\n)\n\nselect * from flagged_errors\norder by sync_start_time desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:24.094950Z", "completed_at": "2025-11-16T01:42:24.099140Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:24.099509Z", "completed_at": "2025-11-16T01:42:25.322467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2282450199127197, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1dc6-0003-035215409c1a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_connector_recommendations", "compiled": true, "compiled_code": "\n\nwith connector_health as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health\n),\n\nmonthly_active_rows as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows\n    where month_date = (select max(month_date) from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows)\n),\n\n-- Calculate connector metrics\nconnector_metrics as (\n    select\n        ch.connection_name,\n        ch.connector_name,\n        ch.destination_name,\n        ch.last_sync_at,\n        ch.last_sync_status,\n        ch.total_syncs,\n        ch.successful_syncs,\n        ch.failed_syncs,\n        ch.avg_sync_duration_seconds,\n        ch.total_syncs_last_7d,\n        ch.failed_syncs_last_7d,\n        ch.success_rate_last_7d,\n        case\n            when ch.total_syncs > 0 then ch.total_syncs / nullif(datediff(day, date_trunc('day', ch.last_sync_at), current_date()), 0)\n            else 0\n        end as avg_syncs_per_day\n    from connector_health ch\n),\n\n-- Calculate active rows by connector\nconnector_active_rows as (\n    select\n        connection_name,\n        sum(total_active_rows) as total_active_rows,\n        sum(free_active_rows) as free_active_rows,\n        sum(paid_active_rows) as paid_active_rows\n    from monthly_active_rows\n    group by 1\n),\n\n-- Generate recommendations\nconnector_recommendations as (\n    select\n        cm.connection_name,\n        cm.connector_name,\n        cm.destination_name,\n        cm.last_sync_at,\n        cm.last_sync_status,\n        cm.total_syncs,\n        cm.successful_syncs,\n        cm.failed_syncs,\n        cm.avg_sync_duration_seconds,\n        cm.avg_syncs_per_day,\n        coalesce(car.total_active_rows, 0) as total_active_rows,\n        coalesce(car.free_active_rows, 0) as free_active_rows,\n        coalesce(car.paid_active_rows, 0) as paid_active_rows,\n        \n        -- Calculate recommendation score (higher = more important to address)\n        case\n            when cm.last_sync_status = 'error' then 100\n            when cm.success_rate_last_7d < 50 then 90\n            when cm.success_rate_last_7d < 80 then 70\n            when cm.avg_sync_duration_seconds > 3600 then 60\n            when cm.avg_syncs_per_day > 24 then 50\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 40\n            else 0\n        end as recommendation_score,\n        \n        -- Determine recommendation priority\n        case\n            when cm.last_sync_status = 'error' then 'Critical'\n            when cm.success_rate_last_7d < 50 then 'High'\n            when cm.success_rate_last_7d < 80 then 'Medium'\n            when cm.avg_sync_duration_seconds > 3600 then 'Medium'\n            when cm.avg_syncs_per_day > 24 then 'Medium'\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 'Low'\n            else 'None'\n        end as recommendation_priority,\n        \n        -- Generate primary recommendation\n        case\n            when cm.last_sync_status = 'error' then 'Fix failing connector'\n            when cm.success_rate_last_7d < 50 then 'Investigate frequent failures'\n            when cm.success_rate_last_7d < 80 then 'Address intermittent failures'\n            when cm.avg_sync_duration_seconds > 3600 then 'Optimize long-running syncs'\n            when cm.avg_syncs_per_day > 24 then 'Reduce sync frequency'\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 'Consider removing unused connector'\n            else 'No action needed'\n        end as primary_recommendation\n        \n    from connector_metrics cm\n    left join connector_active_rows car on cm.connection_name = car.connection_name\n)\n\nselect * from connector_recommendations\norder by recommendation_score desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_recommendations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:24.491012Z", "completed_at": "2025-11-16T01:42:24.494291Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:24.494919Z", "completed_at": "2025-11-16T01:42:25.946741Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4604918956756592, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-16e7-0003-03521540e31a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_problematic_connectors", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_sync_performance\n),\n\nerror_monitoring as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring\n),\n\n-- Calculate error metrics by connector\nconnector_error_metrics as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        count(*) as total_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as error_syncs,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        (sum(case when sync_status = 'error' then 1 else 0 end) / nullif(count(*), 0)) * 100 as error_rate,\n        avg(sync_duration_seconds) as avg_sync_duration,\n        max(sync_duration_seconds) as max_sync_duration\n    from sync_performance\n    where sync_date >= dateadd(day, -30, current_date())\n    group by 1, 2, 3\n),\n\n-- Get recurring error information\nrecurring_error_counts as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as recurring_error_count,\n        count(distinct error_type) as distinct_error_types,\n        max(sync_start_time) as last_error_time\n    from error_monitoring\n    where is_recurring_error = true\n    group by 1, 2\n),\n\n-- Calculate a problem score based on multiple factors\nproblematic_connectors as (\n    select\n        cem.connection_name,\n        cem.connector_name,\n        cem.destination_name,\n        cem.total_syncs,\n        cem.error_syncs,\n        cem.successful_syncs,\n        cem.error_rate,\n        cem.avg_sync_duration,\n        cem.max_sync_duration,\n        coalesce(rec.recurring_error_count, 0) as recurring_error_count,\n        coalesce(rec.distinct_error_types, 0) as distinct_error_types,\n        rec.last_error_time,\n        -- Calculate a problem score (higher is worse)\n        (cem.error_rate * 0.5) + \n        (coalesce(rec.recurring_error_count, 0) * 10) +\n        (coalesce(rec.distinct_error_types, 0) * 5) +\n        (case when rec.last_error_time is not null and rec.last_error_time >= dateadd(day, -1, current_timestamp()) then 20 else 0 end) as problem_score\n    from connector_error_metrics cem\n    left join recurring_error_counts rec \n        on cem.connection_name = rec.connection_name\n        and cem.connector_name = rec.connector_name\n)\n\nselect \n    *,\n    case\n        when problem_score >= 50 then 'Critical'\n        when problem_score >= 30 then 'High'\n        when problem_score >= 10 then 'Medium'\n        else 'Low'\n    end as problem_severity\nfrom problematic_connectors\norder by problem_score desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_problematic_connectors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T01:42:24.487213Z", "completed_at": "2025-11-16T01:42:24.494667Z"}, {"name": "execute", "started_at": "2025-11-16T01:42:24.496912Z", "completed_at": "2025-11-16T01:42:25.938076Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.4522018432617188, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06b66-0007-1cdc-0003-035215407d46"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_executive_dashboard", "compiled": true, "compiled_code": "\n\nwith connector_health as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_connector_health\n),\n\nmonthly_active_rows as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_monthly_active_rows\n),\n\nerror_monitoring as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_error_monitoring\n    -- Remove date filter to include all data\n),\n\n-- Calculate connector health metrics\nconnector_health_metrics as (\n    select\n        current_date() as report_date,\n        count(distinct connection_name) as total_connectors,\n        sum(case when last_sync_status = 'success' then 1 else 0 end) as healthy_connectors,\n        sum(case when last_sync_status = 'error' then 1 else 0 end) as failing_connectors,\n        (sum(case when last_sync_status = 'success' then 1 else 0 end) / \n         nullif(count(distinct connection_name), 0)) * 100 as connector_health_percentage\n    from connector_health\n),\n\n-- Calculate active rows metrics\nactive_rows_metrics as (\n    select\n        current_date() as report_date,\n        sum(total_active_rows) as total_active_rows,\n        sum(paid_active_rows) as paid_active_rows,\n        sum(free_active_rows) as free_active_rows\n    from monthly_active_rows\n    -- Use the most recent month if available\n    where month_date = (select max(month_date) from monthly_active_rows)\n),\n\n-- Calculate error metrics\nerror_metrics as (\n    select\n        current_date() as report_date,\n        count(*) as total_errors,\n        count(distinct connection_name) as connectors_with_errors,\n        count(distinct case when is_recurring_error then connection_name else null end) as connectors_with_recurring_errors\n    from error_monitoring\n),\n\n-- Combine all metrics\nexecutive_dashboard as (\n    select\n        chm.report_date,\n        chm.total_connectors,\n        chm.healthy_connectors,\n        chm.failing_connectors,\n        chm.connector_health_percentage,\n        coalesce(arm.total_active_rows, 0) as total_active_rows,\n        coalesce(arm.paid_active_rows, 0) as paid_active_rows,\n        coalesce(arm.free_active_rows, 0) as free_active_rows,\n        coalesce(em.total_errors, 0) as total_errors,\n        coalesce(em.connectors_with_errors, 0) as connectors_with_errors,\n        coalesce(em.connectors_with_recurring_errors, 0) as connectors_with_recurring_errors\n    from connector_health_metrics chm\n    left join active_rows_metrics arm on chm.report_date = arm.report_date\n    left join error_metrics em on chm.report_date = em.report_date\n)\n\nselect * from executive_dashboard", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fivetran_analytics.fct_fivetran_executive_dashboard", "batch_results": null}], "elapsed_time": 13.432590007781982, "args": {"macro_debugging": false, "quiet": false, "show_resource_report": false, "use_colors": true, "introspect": true, "defer": false, "log_path": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs/logs", "indirect_selection": "eager", "log_format": "default", "partial_parse_file_diff": true, "write_json": true, "exclude": [], "empty": false, "select": [], "require_resource_names_without_spaces": false, "exclude_resource_types": [], "use_colors_file": true, "log_level": "info", "favor_state": false, "log_file_max_bytes": 10485760, "strict_mode": false, "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false, "which": "build", "require_explicit_package_overrides_for_builtin_materializations": true, "print": true, "state_modified_compare_vars": false, "partial_parse": true, "show": false, "profiles_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs", "log_format_file": "debug", "include_saved_query": false, "populate_cache": true, "source_freshness_run_project_hooks": false, "vars": {}, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "invocation_command": "dbt build", "log_level_file": "debug", "resource_types": [], "send_anonymous_usage_stats": true, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"include": [], "exclude": []}, "require_yaml_configuration_for_mf_time_spines": false, "static_parser": true, "project_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs", "require_nested_cumulative_type_params": false, "export_saved_queries": false}}