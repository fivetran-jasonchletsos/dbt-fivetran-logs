{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-11-16T19:56:03.073957Z", "invocation_id": "eedc5413-bc22-461d-b419-e14fd53487dd", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T19:56:00.187363Z", "completed_at": "2025-11-16T19:56:00.197308Z"}, {"name": "execute", "started_at": "2025-11-16T19:56:00.197601Z", "completed_at": "2025-11-16T19:56:02.434697Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2481849193573, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06fac-0007-2084-0003-0352154837e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_connector_health", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance\n),\n\n-- Calculate last sync information\nlast_sync as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        max(sync_end_time) as last_sync_at,\n        max(case when sync_status = 'success' then sync_end_time else null end) as last_successful_sync_at,\n        max(case when sync_status = 'error' then sync_end_time else null end) as last_error_sync_at\n    from sync_performance\n    group by 1, 2, 3\n),\n\n-- Calculate sync status\nsync_status as (\n    select\n        ls.connection_name,\n        ls.connector_name,\n        ls.destination_name,\n        ls.last_sync_at,\n        ls.last_successful_sync_at,\n        ls.last_error_sync_at,\n        case\n            when ls.last_sync_at = ls.last_successful_sync_at then 'success'\n            when ls.last_sync_at = ls.last_error_sync_at then 'error'\n            else 'unknown'\n        end as last_sync_status\n    from last_sync ls\n),\n\n-- Calculate sync metrics for all time\nsync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        count(*) as total_syncs,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,\n        avg(sync_duration_seconds) as avg_sync_duration_seconds,\n        max(sync_duration_seconds) as max_sync_duration_seconds\n    from sync_performance\n    group by 1, 2, 3\n),\n\n-- Calculate recent sync metrics (last 7 days if data exists)\nrecent_sync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        count(*) as total_syncs_last_7d,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs_last_7d,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,\n        case \n            when count(*) > 0 then \n                (sum(case when sync_status = 'success' then 1 else 0 end) / nullif(count(*), 0)) * 100 \n            else null \n        end as success_rate_last_7d\n    from sync_performance\n    where sync_date >= dateadd(day, -7, current_date())\n    group by 1, 2, 3\n),\n\n-- Combine all metrics\nconnector_health as (\n    select\n        ss.connection_name,\n        ss.connector_name,\n        ss.destination_name,\n        ss.last_sync_at,\n        ss.last_successful_sync_at,\n        ss.last_error_sync_at,\n        ss.last_sync_status,\n        coalesce(sm.total_syncs, 0) as total_syncs,\n        coalesce(sm.successful_syncs, 0) as successful_syncs,\n        coalesce(sm.failed_syncs, 0) as failed_syncs,\n        sm.avg_sync_duration_seconds,\n        sm.max_sync_duration_seconds,\n        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,\n        coalesce(rsm.successful_syncs_last_7d, 0) as successful_syncs_last_7d,\n        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,\n        coalesce(rsm.success_rate_last_7d, \n            case \n                when sm.total_syncs > 0 then \n                    (sm.successful_syncs / nullif(sm.total_syncs, 0)) * 100 \n                else null \n            end\n        ) as success_rate_last_7d\n    from sync_status ss\n    left join sync_metrics sm \n        on ss.connection_name = sm.connection_name \n        and ss.connector_name = sm.connector_name\n        and ss.destination_name = sm.destination_name\n    left join recent_sync_metrics rsm \n        on ss.connection_name = rsm.connection_name \n        and ss.connector_name = rsm.connector_name\n        and ss.destination_name = rsm.destination_name\n)\n\nselect * from connector_health", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_connector_health", "batch_results": null}], "elapsed_time": 8.379286050796509, "args": {"require_nested_cumulative_type_params": false, "exclude": [], "log_level": "info", "empty": false, "skip_nodes_if_on_run_start_fails": false, "partial_parse_file_diff": true, "use_colors": true, "vars": {}, "log_path": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs/logs", "invocation_command": "dbt run -s fct_fivetran_connector_health", "source_freshness_run_project_hooks": false, "cache_selected_only": false, "log_level_file": "debug", "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "strict_mode": false, "write_json": true, "show_resource_report": false, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "macro_debugging": false, "select": ["fct_fivetran_connector_health"], "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "partial_parse": true, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "populate_cache": true, "use_colors_file": true, "project_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs", "quiet": false, "print": true, "static_parser": true, "which": "run", "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "indirect_selection": "eager", "printer_width": 80, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "profiles_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs"}}