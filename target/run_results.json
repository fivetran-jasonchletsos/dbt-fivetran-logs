{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-11-16T17:56:44.812436Z", "invocation_id": "d59dfd05-f68f-47ba-9256-cab3f35d06b6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.667299Z", "completed_at": "2025-11-16T17:56:35.674125Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.674985Z", "completed_at": "2025-11-16T17:56:35.980814Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3215963840484619, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c0a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__audit_trail", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.audit_trail\n),\n\nrenamed as (\n    select\n        id as audit_id,\n        user_id,\n        captured_at as event_created_at,\n        action as event_type,\n        interaction_method,\n        primary_resource_type as resource_type,\n        primary_resource_id as resource_id,\n        secondary_resource_type,\n        secondary_resource_id,\n        old_values,\n        new_values,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__audit_trail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.661366Z", "completed_at": "2025-11-16T17:56:35.674376Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.686502Z", "completed_at": "2025-11-16T17:56:35.982553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32367730140686035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__account", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.account\n),\n\nrenamed as (\n    select\n        id as account_id,\n        name as account_name,\n        created_at,\n        status as account_status,\n        country,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__account", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.669256Z", "completed_at": "2025-11-16T17:56:35.674790Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.694635Z", "completed_at": "2025-11-16T17:56:35.984573Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3248460292816162, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c12"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__column_lineage", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.column_lineage\n),\n\nrenamed as (\n    select\n        destination_column_id,\n        source_column_id,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__column_lineage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.672118Z", "completed_at": "2025-11-16T17:56:35.674600Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.693475Z", "completed_at": "2025-11-16T17:56:36.864388Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2044591903686523, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c16"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__connection", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connection\n),\n\nrenamed as (\n    select\n        connection_id,\n        connection_name,\n        connector_type_id,\n        destination_id,\n        connecting_user_id,\n        signed_up as created_at,\n        paused as is_paused,\n        sync_frequency,\n        deployment_type,\n        _fivetran_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.993472Z", "completed_at": "2025-11-16T17:56:35.996249Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.996753Z", "completed_at": "2025-11-16T17:56:36.867685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8778059482574463, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c22"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__connector_type", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connector_type\n),\n\nrenamed as (\n    select\n        id as connector_type_id,\n        official_connector_name as connector_name,\n        type as connector_type,\n        availability as availability_status,\n        created_at,\n        public_beta_at,\n        release_at as released_at,\n        deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.990816Z", "completed_at": "2025-11-16T17:56:35.996604Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.999122Z", "completed_at": "2025-11-16T17:56:36.870124Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.880465030670166, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c1e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__connector_sdk_log", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.connector_sdk_log\n),\n\nrenamed as (\n    select\n        id as log_id,\n        connection_id,\n        sync_id,\n        event_time as logged_at,\n        level as log_level,\n        message as log_message,\n        message_origin,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_sdk_log", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:35.994767Z", "completed_at": "2025-11-16T17:56:35.996436Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:35.998019Z", "completed_at": "2025-11-16T17:56:37.471019Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.4809238910675049, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c1a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination\n),\n\nrenamed as (\n    select\n        id as destination_id,\n        name as destination_name,\n        account_id,\n        created_at,\n        region,\n        is_active,\n        deployment_type,\n        destination_type,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:36.881519Z", "completed_at": "2025-11-16T17:56:36.883682Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:36.884371Z", "completed_at": "2025-11-16T17:56:37.759789Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8835439682006836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c26"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_schema", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_schema\n),\n\nrenamed as (\n    select\n        id as destination_schema_id,\n        destination_id,\n        connection_id,\n        name as schema_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_schema", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:36.877415Z", "completed_at": "2025-11-16T17:56:36.884171Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:36.888643Z", "completed_at": "2025-11-16T17:56:37.772544Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8969531059265137, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c2e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_column", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_column\n),\n\nrenamed as (\n    select\n        id as destination_column_id,\n        destination_id,\n        table_id as destination_table_id,\n        connection_id,\n        name as column_name,\n        type as data_type,\n        created_at,\n        updated_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_column", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:36.879691Z", "completed_at": "2025-11-16T17:56:36.883938Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:36.886023Z", "completed_at": "2025-11-16T17:56:37.880264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0042870044708252, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c2a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_column_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_column_change_event\n),\n\nrenamed as (\n    select\n        column_id as destination_column_id,\n        destination_id,\n        connection_id,\n        attribute_name,\n        change_type,\n        new_value,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_column_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:37.472902Z", "completed_at": "2025-11-16T17:56:37.474922Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:37.475216Z", "completed_at": "2025-11-16T17:56:37.883487Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4110591411590576, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c32"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_schema_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_schema_change_event\n),\n\nrenamed as (\n    select\n        schema_id as destination_schema_id,\n        destination_id,\n        connection_id,\n        change_type,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_schema_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:37.776856Z", "completed_at": "2025-11-16T17:56:37.779750Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:37.780061Z", "completed_at": "2025-11-16T17:56:38.093699Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.31741809844970703, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c36"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_table_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_table_change_event\n),\n\nrenamed as (\n    select\n        table_id as destination_table_id,\n        destination_id,\n        connection_id,\n        change_type,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_table_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:37.763594Z", "completed_at": "2025-11-16T17:56:37.767585Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:37.767909Z", "completed_at": "2025-11-16T17:56:38.151339Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.38863611221313477, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c3a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__destination_table", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.destination_table\n),\n\nrenamed as (\n    select\n        id as destination_table_id,\n        destination_id,\n        schema_id as destination_schema_id,\n        connection_id,\n        name as table_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination_table", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:37.890903Z", "completed_at": "2025-11-16T17:56:37.893619Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:37.897039Z", "completed_at": "2025-11-16T17:56:38.224225Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.33647799491882324, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c42"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__log", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.log\n),\n\nrenamed as (\n    select\n        id as log_id,\n        sync_id,\n        time_stamp as logged_at,\n        event as event_type,\n        connection_id,\n        message_event as message_type,\n        message_data as message_content,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:37.888099Z", "completed_at": "2025-11-16T17:56:37.893310Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:37.893847Z", "completed_at": "2025-11-16T17:56:38.241163Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35448503494262695, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c3e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__incremental_mar", "compiled": true, "compiled_code": "with source as (\n\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.incremental_mar\n\n),\n\nrenamed as (\n\n    select\n        connection_name,\n        destination_id,\n        measured_date,\n        schema_name,\n        table_name,\n        sync_type,\n        incremental_rows,\n        case \n            when free_type = 'FREE' then true \n            when free_type = 'PAID' then false \n            else null \n        end as is_free,\n        updated_at,\n        _fivetran_synced\n    from source\n\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.095175Z", "completed_at": "2025-11-16T17:56:38.096822Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.096959Z", "completed_at": "2025-11-16T17:56:38.319489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22466802597045898, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c46"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__resource_membership", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.resource_membership\n),\n\nrenamed as (\n    select\n        id as resource_membership_id,\n        role_id,\n        team_id,\n        user_id,\n        account_id,\n        destination_id,\n        connection_id,\n        organization_id,\n        created_at,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__resource_membership", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.152901Z", "completed_at": "2025-11-16T17:56:38.154629Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.154798Z", "completed_at": "2025-11-16T17:56:38.420561Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.26802706718444824, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c4a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__role", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.role\n),\n\nrenamed as (\n    select\n        id as role_id,\n        name as role_name,\n        description as role_description,\n        account_id,\n        connector_types,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__role", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.243342Z", "completed_at": "2025-11-16T17:56:38.245342Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.245512Z", "completed_at": "2025-11-16T17:56:38.550649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3078148365020752, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c52"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__role_permission", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.role_permission\n),\n\nrenamed as (\n    select\n        role_id,\n        permission,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__role_permission", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.226491Z", "completed_at": "2025-11-16T17:56:38.228743Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.228940Z", "completed_at": "2025-11-16T17:56:38.560956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.33501219749450684, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c4e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__role_connector_type", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.role_connector_type\n),\n\nrenamed as (\n    select\n        role_id,\n        connector_type,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__role_connector_type", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.321385Z", "completed_at": "2025-11-16T17:56:38.323446Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.323623Z", "completed_at": "2025-11-16T17:56:38.642831Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.32193517684936523, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c56"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__schema_lineage", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.schema_lineage\n),\n\nrenamed as (\n    select\n        destination_schema_id,\n        source_schema_id,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__schema_lineage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.422812Z", "completed_at": "2025-11-16T17:56:38.425408Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.425634Z", "completed_at": "2025-11-16T17:56:38.770446Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3482041358947754, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c5a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_column", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_column\n),\n\nrenamed as (\n    select\n        id as source_column_id,\n        connection_id,\n        table_id as source_table_id,\n        name as column_name,\n        type as data_type,\n        is_primary_key,\n        created_at,\n        updated_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_column", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.553436Z", "completed_at": "2025-11-16T17:56:38.556090Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.556342Z", "completed_at": "2025-11-16T17:56:38.819854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.267056941986084, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c5e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_column_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_column_change_event\n),\n\nrenamed as (\n    select\n        column_id as source_column_id,\n        connection_id,\n        attribute_name,\n        entity_type,\n        change_type,\n        new_value,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_column_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.645278Z", "completed_at": "2025-11-16T17:56:38.647438Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.647650Z", "completed_at": "2025-11-16T17:56:38.927804Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.28308820724487305, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c6a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_schema", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_schema\n),\n\nrenamed as (\n    select\n        id as source_schema_id,\n        connection_id,\n        name as schema_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_schema", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.563936Z", "completed_at": "2025-11-16T17:56:38.566246Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.566634Z", "completed_at": "2025-11-16T17:56:38.821324Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.25817394256591797, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c62"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_foreign_key", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_foreign_key\n),\n\nrenamed as (\n    select\n        column_id as source_column_id,\n        ordinal,\n        foreign_key_reference,\n        created_at,\n        updated_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_foreign_key", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.824967Z", "completed_at": "2025-11-16T17:56:38.827973Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.828195Z", "completed_at": "2025-11-16T17:56:39.108728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2844889163970947, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c7a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_table", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_table\n),\n\nrenamed as (\n    select\n        id as source_table_id,\n        connection_id,\n        schema_id as source_schema_id,\n        name as table_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_table", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:38.773256Z", "completed_at": "2025-11-16T17:56:38.776722Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:38.776953Z", "completed_at": "2025-11-16T17:56:39.217534Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4449880123138428, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c72"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_schema_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_schema_change_event\n),\n\nrenamed as (\n    select\n        schema_id as source_schema_id,\n        connection_id,\n        change_type,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_schema_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.030542Z", "completed_at": "2025-11-16T17:56:39.032684Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.034657Z", "completed_at": "2025-11-16T17:56:39.516455Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.48679089546203613, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c82"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__table_lineage", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.table_lineage\n),\n\nrenamed as (\n    select\n        destination_table_id,\n        source_table_id,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__table_lineage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.027977Z", "completed_at": "2025-11-16T17:56:39.032460Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.032899Z", "completed_at": "2025-11-16T17:56:39.624876Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.598085880279541, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c86"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__source_table_change_event", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.source_table_change_event\n),\n\nrenamed as (\n    select\n        table_id as source_table_id,\n        connection_id,\n        change_type,\n        detected_at as change_detected_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__source_table_change_event", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.111125Z", "completed_at": "2025-11-16T17:56:39.114745Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.114950Z", "completed_at": "2025-11-16T17:56:39.628460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5178890228271484, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c8e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__team", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.team\n),\n\nrenamed as (\n    select\n        id as team_id,\n        name as team_name,\n        description as team_description,\n        parent_id as parent_team_id,\n        account_id,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__team", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.220349Z", "completed_at": "2025-11-16T17:56:39.223118Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.223388Z", "completed_at": "2025-11-16T17:56:39.673908Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4542090892791748, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c92"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__team_membership", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.team_membership\n),\n\nrenamed as (\n    select\n        team_id,\n        role_id,\n        user_id,\n        created_at,\n        _fivetran_deleted as is_deleted,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__team_membership", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.519469Z", "completed_at": "2025-11-16T17:56:39.522102Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.522353Z", "completed_at": "2025-11-16T17:56:39.761414Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.24249601364135742, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c96"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__transformation_runs", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.transformation_runs\n),\n\nrenamed as (\n    select\n        destination_id,\n        job_id,\n        measured_date,\n        project_type,\n        case \n            when free_type = 'free' then true\n            else false\n        end as is_free,\n        job_name,\n        updated_at,\n        model_runs,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__transformation_runs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.630732Z", "completed_at": "2025-11-16T17:56:39.635875Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.636094Z", "completed_at": "2025-11-16T17:56:39.962542Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3330261707305908, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c9e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.stg_fivetran_log__user", "compiled": true, "compiled_code": "with source as (\n    select * from JASON_CHLETSOS.JASON_CHLETSOS_FIVETRAN_LOG.user\n),\n\nrenamed as (\n    select\n        id as user_id,\n        email,\n        given_name as first_name,\n        family_name as last_name,\n        created_at,\n        _fivetran_synced\n    from source\n)\n\nselect * from renamed", "relation_name": "JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.633634Z", "completed_at": "2025-11-16T17:56:39.637807Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.638046Z", "completed_at": "2025-11-16T17:56:39.988754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3557159900665283, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477c9a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__connector_details", "compiled": true, "compiled_code": "with connections as (\n    \n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n\n),\n\ndestinations as (\n\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\n\n),\n\nconnector_types as (\n\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\n\n),\n\nconnector_details as (\n\n    select\n        connections.connection_id,\n        connections.connection_name,\n        connections.connector_type_id,\n        connector_types.connector_name,\n        connections.created_at as connection_created_at,\n        connections.destination_id,\n        destinations.destination_name,\n        connections.is_paused\n    from connections\n    left join destinations \n        on connections.destination_id = destinations.destination_id\n    left join connector_types \n        on connections.connector_type_id = connector_types.connector_type_id\n\n)\n\nselect * from connector_details", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.675942Z", "completed_at": "2025-11-16T17:56:39.723200Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.723352Z", "completed_at": "2025-11-16T17:56:40.009041Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.33358001708984375, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477ca2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__daily_api_calls", "compiled": true, "compiled_code": "with logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnections as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n),\n\n-- Filter to API call events\napi_calls as (\n    select\n        connection_id,\n        date_trunc('day', logged_at) as date_day,\n        count(*) as api_calls_count\n    from logs\n    where event_type = 'api_call'\n    group by 1, 2\n),\n\n-- Join with connection information\nenriched_api_calls as (\n    select\n        a.date_day,\n        a.connection_id,\n        c.connection_name,\n        c.destination_id,\n        a.api_calls_count\n    from api_calls a\n    left join connections c on a.connection_id = c.connection_id\n)\n\nselect * from enriched_api_calls", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.763034Z", "completed_at": "2025-11-16T17:56:39.765134Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.765286Z", "completed_at": "2025-11-16T17:56:40.145237Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.38259315490722656, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477ca6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__sync_events", "compiled": true, "compiled_code": "with logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnections as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connection\n),\n\ndestinations as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__destination\n),\n\nconnector_types as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__connector_type\n),\n\n-- Extract sync information from message content\nsync_logs as (\n    select\n        log_id,\n        sync_id,\n        connection_id,\n        logged_at as sync_time,\n        message_content,\n        event_type,\n        case \n            when event_type = 'SEVERE' then 'error'\n            when event_type = 'WARNING' then 'warning'\n            else 'info'\n        end as sync_status,\n        case\n            when message_content like '%rows synced%' then\n                try_cast(regexp_substr(message_content, '[0-9]+') as integer)\n            else null\n        end as rows_synced\n    from logs\n    where message_content like '%sync%' \n       or message_content like '%Sync%'\n       or message_content like '%rows synced%'\n),\n\n-- Group by connection to get sync metrics\nconnection_syncs as (\n    select\n        connection_id,\n        min(sync_time) as first_sync_time,\n        max(sync_time) as last_sync_time,\n        count(*) as sync_count,\n        sum(case when sync_status = 'error' then 1 else 0 end) as error_count,\n        sum(coalesce(rows_synced, 0)) as total_rows_synced\n    from sync_logs\n    group by 1\n),\n\n-- Join with connection and destination information\ncombined_syncs as (\n    select\n        cs.connection_id,\n        c.connection_name,\n        ct.connector_name,\n        cs.first_sync_time,\n        cs.last_sync_time,\n        cs.sync_count,\n        cs.error_count,\n        cs.total_rows_synced,\n        (cs.sync_count - cs.error_count) / nullif(cs.sync_count, 0) * 100 as success_rate,\n        c.destination_id,\n        d.destination_name\n    from connection_syncs cs\n    left join connections c on cs.connection_id = c.connection_id\n    left join destinations d on c.destination_id = d.destination_id\n    left join connector_types ct on c.connector_type_id = ct.connector_type_id\n)\n\nselect * from combined_syncs", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__sync_events", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.965240Z", "completed_at": "2025-11-16T17:56:39.967996Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.968202Z", "completed_at": "2025-11-16T17:56:40.279635Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.31502389907836914, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.int_fivetran_log__daily_active_rows", "compiled": true, "compiled_code": "with incremental_mar as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar\n),\n\n-- Aggregate to daily level\ndaily_active_rows as (\n    select\n        measured_date as date_day,\n        connection_name,\n        destination_id,\n        schema_name,\n        table_name,\n        is_free,\n        sum(incremental_rows) as active_rows\n    from incremental_mar\n    group by 1, 2, 3, 4, 5, 6\n)\n\nselect * from daily_active_rows", "relation_name": "JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_active_rows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:40.012884Z", "completed_at": "2025-11-16T17:56:40.015764Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:40.015948Z", "completed_at": "2025-11-16T17:56:40.849510Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8372149467468262, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cb2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_schema_change_history", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract schema change events from logs\nschema_change_events as (\n    select\n        log_id,\n        logged_at as change_detected_at,\n        connection_id,\n        message_type,\n        message_content,\n        -- Extract schema and table information from message content\n        regexp_substr(message_content, 'schema ([^\\\\s]+)', 1, 1, 'e') as schema_name,\n        regexp_substr(message_content, 'table ([^\\\\s\\\\.]+)', 1, 1, 'e') as table_name,\n        -- Determine change type\n        case\n            when message_type like '%column_added%' then 'Column Added'\n            when message_type like '%column_removed%' then 'Column Removed'\n            when message_type like '%column_renamed%' then 'Column Renamed'\n            when message_type like '%column_type_changed%' then 'Column Type Changed'\n            when message_type like '%table_added%' then 'Table Added'\n            when message_type like '%table_removed%' then 'Table Removed'\n            when message_type like '%table_renamed%' then 'Table Renamed'\n            when message_type like '%schema_added%' then 'Schema Added'\n            when message_type like '%schema_removed%' then 'Schema Removed'\n            when message_type like '%schema_renamed%' then 'Schema Renamed'\n            else 'Other Schema Change'\n        end as change_type,\n        -- Extract column information\n        regexp_substr(message_content, 'column ([^\\\\s]+)', 1, 1, 'e') as column_name,\n        -- Extract data type information for type changes\n        case \n            when message_type like '%column_type_changed%' then \n                regexp_substr(message_content, 'from ([^\\\\s]+) to', 1, 1, 'e')\n            else null\n        end as previous_data_type,\n        case \n            when message_type like '%column_type_changed%' then \n                regexp_substr(message_content, 'to ([^\\\\s\\\\.]+)', 1, 1, 'e')\n            else null\n        end as new_data_type\n    from logs\n    where event_type = 'schema_change'\n),\n\n-- Enrich with connector information\nenriched_schema_changes as (\n    select\n        sce.change_detected_at,\n        cd.connection_name,\n        cd.connector_name,\n        sce.schema_name,\n        sce.table_name,\n        sce.change_type,\n        sce.column_name,\n        sce.previous_data_type,\n        sce.new_data_type\n    from schema_change_events sce\n    left join connector_details cd on sce.connection_id = cd.connection_id\n    where sce.schema_name is not null\n)\n\nselect * from enriched_schema_changes\norder by change_detected_at desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_schema_change_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:40.282574Z", "completed_at": "2025-11-16T17:56:40.286199Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:40.286455Z", "completed_at": "2025-11-16T17:56:41.065932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7840168476104736, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cc2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_user_activity", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nusers as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__user\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract user activity events from logs\nuser_activity_events as (\n    select\n        logged_at,\n        connection_id,\n        event_type,\n        message_type,\n        message_content\n    from logs\n    where event_type in ('user_action', 'account_modification', 'setup')\n),\n\n-- Categorize user actions\ncategorized_actions as (\n    select\n        date_trunc('day', logged_at) as activity_date,\n        connection_id,\n        -- Determine action type\n        case\n            when message_type like '%create%' then 'Create'\n            when message_type like '%update%' then 'Update'\n            when message_type like '%delete%' then 'Delete'\n            when message_type like '%enable%' then 'Enable'\n            when message_type like '%disable%' then 'Disable'\n            when message_type like '%pause%' then 'Pause'\n            when message_type like '%resume%' then 'Resume'\n            when message_type like '%sync%' then 'Sync'\n            when message_type like '%login%' then 'Login'\n            else 'Other'\n        end as action_type,\n        -- Determine resource type\n        case\n            when message_type like '%connection%' then 'Connection'\n            when message_type like '%destination%' then 'Destination'\n            when message_type like '%schema%' then 'Schema'\n            when message_type like '%table%' then 'Table'\n            when message_type like '%user%' then 'User'\n            when message_type like '%account%' then 'Account'\n            else 'Other'\n        end as resource_type,\n        -- Extract user information if available\n        regexp_substr(message_content, 'by user ([^\\\\s]+)', 1, 1, 'e') as user_email,\n        -- Extract resource name if available\n        case\n            when message_type like '%connection%' then \n                regexp_substr(message_content, 'connection ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%destination%' then \n                regexp_substr(message_content, 'destination ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%schema%' then \n                regexp_substr(message_content, 'schema ([^\\\\s]+)', 1, 1, 'e')\n            when message_type like '%table%' then \n                regexp_substr(message_content, 'table ([^\\\\s]+)', 1, 1, 'e')\n            else null\n        end as resource_name,\n        count(*) as activity_count\n    from user_activity_events\n    group by 1, 2, 3, 4, 5, 6\n),\n\n-- Enrich with user and connection information\nenriched_user_activity as (\n    select\n        ca.activity_date,\n        coalesce(u.user_id, 'unknown') as user_id,\n        coalesce(ca.user_email, u.email, 'unknown') as user_email,\n        concat(coalesce(u.first_name, ''), ' ', coalesce(u.last_name, '')) as user_name,\n        ca.action_type,\n        ca.resource_type,\n        coalesce(ca.resource_name, cd.connection_name, 'unknown') as resource_name,\n        ca.activity_count\n    from categorized_actions ca\n    left join users u on ca.user_email = u.email\n    left join connector_details cd on ca.connection_id = cd.connection_id\n)\n\nselect * from enriched_user_activity\norder by activity_date desc, user_email, action_type", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_user_activity", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:40.851149Z", "completed_at": "2025-11-16T17:56:40.852838Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:40.852983Z", "completed_at": "2025-11-16T17:56:41.568397Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7177908420562744, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_daily_api_usage", "compiled": true, "compiled_code": "with daily_api_calls as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__daily_api_calls\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Enrich with connector and destination information\nenriched_api_calls as (\n    select\n        dac.date_day,\n        dac.connection_id,\n        dac.connection_name,\n        cd.connector_name,\n        cd.destination_name,\n        dac.api_calls_count\n    from daily_api_calls dac\n    left join connector_details cd on dac.connection_id = cd.connection_id\n)\n\nselect * from enriched_api_calls", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_daily_api_usage", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:40.147459Z", "completed_at": "2025-11-16T17:56:40.150362Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:40.150606Z", "completed_at": "2025-11-16T17:56:41.687014Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.540207862854004, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cbe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_sync_performance", "compiled": true, "compiled_code": "\n\nwith logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Extract detailed sync information from logs\ndetailed_syncs as (\n    select\n        l.log_id,\n        l.sync_id,\n        l.connection_id,\n        l.logged_at as sync_time,\n        cd.connection_name,\n        cd.connector_name,\n        cd.destination_name,\n        date(l.logged_at) as sync_date,\n        l.event_type,\n        l.message_content,\n        case \n            when l.event_type = 'SEVERE' then 'error'\n            when l.event_type = 'WARNING' then 'warning'\n            else 'success'\n        end as sync_status,\n        case\n            when l.message_content like '%rows synced%' then\n                try_cast(regexp_substr(l.message_content, '[0-9]+') as integer)\n            else null\n        end as rows_synced\n    from logs l\n    join connector_details cd on l.connection_id = cd.connection_id\n    where l.message_content like '%sync%' \n       or l.message_content like '%Sync%'\n       or l.message_content like '%rows synced%'\n),\n\n-- Group syncs by ID to get metrics\nsync_metrics as (\n    select\n        sync_id,\n        connection_id,\n        connection_name,\n        connector_name,\n        destination_name,\n        min(sync_time) as sync_start_time,\n        max(sync_time) as sync_end_time,\n        date(min(sync_time)) as sync_date,\n        max(case when sync_status = 'error' then 1 else 0 end) > 0 as has_errors,\n        max(rows_synced) as rows_synced\n    from detailed_syncs\n    where sync_id is not null\n    group by 1, 2, 3, 4, 5\n),\n\n-- Calculate final metrics\nfinal_syncs as (\n    select\n        sync_id,\n        connection_id,\n        connection_name,\n        connector_name,\n        destination_name,\n        sync_start_time,\n        sync_end_time,\n        sync_date,\n        case when has_errors then 'error' else 'success' end as sync_status,\n        datediff(second, sync_start_time, sync_end_time) as sync_duration_seconds,\n        coalesce(rows_synced, 0) as rows_synced\n    from sync_metrics\n)\n\nselect * from final_syncs", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:39.990985Z", "completed_at": "2025-11-16T17:56:39.993792Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:39.994018Z", "completed_at": "2025-11-16T17:56:42.695708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7052948474884033, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cb6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_monthly_active_rows", "compiled": true, "compiled_code": "\n\nwith incremental_mar as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__incremental_mar\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Get all months in the data\nmonths as (\n    select distinct \n        date_trunc('month', measured_date) as month_date\n    from incremental_mar\n),\n\n-- Get all connector, schema, table combinations\nconnector_schema_tables as (\n    select distinct\n        connection_name,\n        schema_name,\n        table_name\n    from incremental_mar\n),\n\n-- Create a cross join of all months and connector/schema/tables\nmonth_connector_combinations as (\n    select\n        m.month_date,\n        cst.connection_name,\n        cst.schema_name,\n        cst.table_name\n    from months m\n    cross join connector_schema_tables cst\n),\n\n-- Calculate monthly active rows\nmonthly_active_rows as (\n    select\n        date_trunc('month', measured_date) as month_date,\n        connection_name,\n        schema_name,\n        table_name,\n        sum(incremental_rows) as active_rows,\n        sum(case when is_free then incremental_rows else 0 end) as free_active_rows,\n        sum(case when not is_free then incremental_rows else 0 end) as paid_active_rows\n    from incremental_mar\n    group by 1, 2, 3, 4\n),\n\n-- Join with connector details\nenriched_monthly_active_rows as (\n    select\n        mcc.month_date,\n        mcc.connection_name,\n        cd.connector_name,\n        mcc.schema_name,\n        mcc.table_name,\n        coalesce(mar.free_active_rows, 0) as free_active_rows,\n        coalesce(mar.paid_active_rows, 0) as paid_active_rows,\n        coalesce(mar.active_rows, 0) as total_active_rows\n    from month_connector_combinations mcc\n    left join monthly_active_rows mar \n        on mcc.month_date = mar.month_date\n        and mcc.connection_name = mar.connection_name\n        and mcc.schema_name = mar.schema_name\n        and mcc.table_name = mar.table_name\n    left join connector_details cd \n        on mcc.connection_name = cd.connection_name\n)\n\nselect * from enriched_monthly_active_rows\norder by month_date desc, total_active_rows desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_monthly_active_rows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:41.697973Z", "completed_at": "2025-11-16T17:56:41.701686Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:41.702574Z", "completed_at": "2025-11-16T17:56:42.721234Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.029555082321167, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cd2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_sync_performance_trends", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance\n),\n\n-- Calculate daily sync metrics\ndaily_sync_metrics as (\n    select\n        sync_date,\n        connection_name,\n        connector_name,\n        count(*) as sync_count,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,\n        avg(sync_duration_seconds) as avg_sync_duration,\n        max(sync_duration_seconds) as max_sync_duration,\n        min(sync_duration_seconds) as min_sync_duration,\n        sum(rows_synced) as total_rows_synced\n    from sync_performance\n    where sync_date >= dateadd(day, -90, current_date())\n    group by 1, 2, 3\n),\n\n-- Calculate rolling averages\nrolling_metrics as (\n    select\n        sync_date,\n        connection_name,\n        connector_name,\n        sync_count,\n        successful_syncs,\n        failed_syncs,\n        avg_sync_duration,\n        max_sync_duration,\n        min_sync_duration,\n        total_rows_synced,\n        -- Calculate 7-day rolling averages\n        avg(avg_sync_duration) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_avg_duration,\n        avg(total_rows_synced) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_avg_rows,\n        -- Calculate success rate\n        (successful_syncs / nullif(sync_count, 0)) * 100 as success_rate,\n        -- Calculate 7-day rolling success rate\n        avg((successful_syncs / nullif(sync_count, 0)) * 100) over (\n            partition by connection_name, connector_name\n            order by sync_date\n            rows between 6 preceding and current row\n        ) as rolling_7d_success_rate\n    from daily_sync_metrics\n)\n\nselect * from rolling_metrics\norder by sync_date desc, connection_name, connector_name", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance_trends", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:41.695816Z", "completed_at": "2025-11-16T17:56:41.702216Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:41.705590Z", "completed_at": "2025-11-16T17:56:42.726360Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0349886417388916, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cda"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_error_monitoring", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance\n    -- Remove date filter to include all data\n),\n\nconnector_details as (\n    select * from JASON_CHLETSOS.fivetran_analytics_int_fivetran_log.int_fivetran_log__connector_details\n),\n\n-- Get error logs\nerror_logs as (\n    select * from JASON_CHLETSOS.fivetran_analytics_stg_fivetran_log.stg_fivetran_log__log\n    where event_type = 'error'\n),\n\n-- Get failed syncs\nfailed_syncs as (\n    select\n        sync_id,\n        connection_name,\n        connector_name,\n        sync_start_time,\n        sync_end_time,\n        sync_date,\n        rows_synced\n    from sync_performance\n    where sync_status = 'error'\n),\n\n-- Create simple error types based on sync failures\nsync_errors as (\n    select\n        fs.sync_id,\n        fs.connection_name,\n        fs.connector_name,\n        fs.sync_start_time,\n        fs.sync_end_time,\n        fs.sync_date,\n        fs.rows_synced,\n        'Sync Failure' as error_message,\n        'Sync Error' as error_type\n    from failed_syncs fs\n),\n\n-- Identify recurring errors\nrecurring_errors as (\n    select\n        connection_name,\n        connector_name,\n        error_type,\n        count(*) as occurrence_count\n    from sync_errors\n    group by 1, 2, 3\n    having count(*) > 1\n),\n\n-- Flag recurring errors\nflagged_errors as (\n    select\n        se.*,\n        case when re.connection_name is not null then true else false end as is_recurring_error,\n        coalesce(re.occurrence_count, 1) as error_occurrence_count\n    from sync_errors se\n    left join recurring_errors re \n        on se.connection_name = re.connection_name\n        and se.connector_name = re.connector_name\n        and se.error_type = re.error_type\n)\n\nselect * from flagged_errors\norder by sync_start_time desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_error_monitoring", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:41.693088Z", "completed_at": "2025-11-16T17:56:41.701929Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:41.704179Z", "completed_at": "2025-11-16T17:56:42.948562Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.257396936416626, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cd6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_connector_health", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance\n),\n\n-- Calculate last sync information\nlast_sync as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        max(sync_end_time) as last_sync_at,\n        max(case when sync_status = 'success' then sync_end_time else null end) as last_successful_sync_at,\n        max(case when sync_status = 'error' then sync_end_time else null end) as last_error_sync_at\n    from sync_performance\n    group by 1, 2, 3\n),\n\n-- Calculate sync status\nsync_status as (\n    select\n        ls.connection_name,\n        ls.connector_name,\n        ls.destination_name,\n        ls.last_sync_at,\n        ls.last_successful_sync_at,\n        ls.last_error_sync_at,\n        case\n            when ls.last_sync_at = ls.last_successful_sync_at then 'success'\n            when ls.last_sync_at = ls.last_error_sync_at then 'error'\n            else 'unknown'\n        end as last_sync_status\n    from last_sync ls\n),\n\n-- Calculate sync metrics for all time\nsync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as total_syncs,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs,\n        avg(sync_duration_seconds) as avg_sync_duration_seconds,\n        max(sync_duration_seconds) as max_sync_duration_seconds\n    from sync_performance\n    group by 1, 2\n),\n\n-- Calculate recent sync metrics (last 7 days if data exists)\nrecent_sync_metrics as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as total_syncs_last_7d,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs_last_7d,\n        sum(case when sync_status = 'error' then 1 else 0 end) as failed_syncs_last_7d,\n        case \n            when count(*) > 0 then \n                (sum(case when sync_status = 'success' then 1 else 0 end) / nullif(count(*), 0)) * 100 \n            else null \n        end as success_rate_last_7d\n    from sync_performance\n    where sync_date >= dateadd(day, -7, current_date())\n    group by 1, 2\n),\n\n-- Combine all metrics\nconnector_health as (\n    select\n        ss.connection_name,\n        ss.connector_name,\n        ss.destination_name,\n        ss.last_sync_at,\n        ss.last_successful_sync_at,\n        ss.last_error_sync_at,\n        ss.last_sync_status,\n        coalesce(sm.total_syncs, 0) as total_syncs,\n        coalesce(sm.successful_syncs, 0) as successful_syncs,\n        coalesce(sm.failed_syncs, 0) as failed_syncs,\n        sm.avg_sync_duration_seconds,\n        sm.max_sync_duration_seconds,\n        coalesce(rsm.total_syncs_last_7d, 0) as total_syncs_last_7d,\n        coalesce(rsm.successful_syncs_last_7d, 0) as successful_syncs_last_7d,\n        coalesce(rsm.failed_syncs_last_7d, 0) as failed_syncs_last_7d,\n        coalesce(rsm.success_rate_last_7d, \n            case \n                when sm.total_syncs > 0 then \n                    (sm.successful_syncs / nullif(sm.total_syncs, 0)) * 100 \n                else null \n            end\n        ) as success_rate_last_7d\n    from sync_status ss\n    left join sync_metrics sm on ss.connection_name = sm.connection_name and ss.connector_name = sm.connector_name\n    left join recent_sync_metrics rsm on ss.connection_name = rsm.connection_name and ss.connector_name = rsm.connector_name\n)\n\nselect * from connector_health", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_connector_health", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:42.729174Z", "completed_at": "2025-11-16T17:56:42.733143Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:42.733791Z", "completed_at": "2025-11-16T17:56:43.824903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.096388816833496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477ce6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_problematic_connectors", "compiled": true, "compiled_code": "\n\nwith sync_performance as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_sync_performance\n),\n\nerror_monitoring as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_error_monitoring\n),\n\n-- Calculate error metrics by connector\nconnector_error_metrics as (\n    select\n        connection_name,\n        connector_name,\n        destination_name,\n        count(*) as total_syncs,\n        sum(case when sync_status = 'error' then 1 else 0 end) as error_syncs,\n        sum(case when sync_status = 'success' then 1 else 0 end) as successful_syncs,\n        (sum(case when sync_status = 'error' then 1 else 0 end) / nullif(count(*), 0)) * 100 as error_rate,\n        avg(sync_duration_seconds) as avg_sync_duration,\n        max(sync_duration_seconds) as max_sync_duration\n    from sync_performance\n    where sync_date >= dateadd(day, -30, current_date())\n    group by 1, 2, 3\n),\n\n-- Get recurring error information\nrecurring_error_counts as (\n    select\n        connection_name,\n        connector_name,\n        count(*) as recurring_error_count,\n        count(distinct error_type) as distinct_error_types,\n        max(sync_start_time) as last_error_time\n    from error_monitoring\n    where is_recurring_error = true\n    group by 1, 2\n),\n\n-- Calculate a problem score based on multiple factors\nproblematic_connectors as (\n    select\n        cem.connection_name,\n        cem.connector_name,\n        cem.destination_name,\n        cem.total_syncs,\n        cem.error_syncs,\n        cem.successful_syncs,\n        cem.error_rate,\n        cem.avg_sync_duration,\n        cem.max_sync_duration,\n        coalesce(rec.recurring_error_count, 0) as recurring_error_count,\n        coalesce(rec.distinct_error_types, 0) as distinct_error_types,\n        rec.last_error_time,\n        -- Calculate a problem score (higher is worse)\n        (cem.error_rate * 0.5) + \n        (coalesce(rec.recurring_error_count, 0) * 10) +\n        (coalesce(rec.distinct_error_types, 0) * 5) +\n        (case when rec.last_error_time is not null and rec.last_error_time >= dateadd(day, -1, current_timestamp()) then 20 else 0 end) as problem_score\n    from connector_error_metrics cem\n    left join recurring_error_counts rec \n        on cem.connection_name = rec.connection_name\n        and cem.connector_name = rec.connector_name\n)\n\nselect \n    *,\n    case\n        when problem_score >= 50 then 'Critical'\n        when problem_score >= 30 then 'High'\n        when problem_score >= 10 then 'Medium'\n        else 'Low'\n    end as problem_severity\nfrom problematic_connectors\norder by problem_score desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_problematic_connectors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:42.951500Z", "completed_at": "2025-11-16T17:56:42.955884Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:42.957549Z", "completed_at": "2025-11-16T17:56:44.324407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3737359046936035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_connector_recommendations", "compiled": true, "compiled_code": "\n\nwith connector_health as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_connector_health\n),\n\nmonthly_active_rows as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_monthly_active_rows\n    where month_date = (select max(month_date) from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_monthly_active_rows)\n),\n\n-- Calculate connector metrics\nconnector_metrics as (\n    select\n        ch.connection_name,\n        ch.connector_name,\n        ch.destination_name,\n        ch.last_sync_at,\n        ch.last_sync_status,\n        ch.total_syncs,\n        ch.successful_syncs,\n        ch.failed_syncs,\n        ch.avg_sync_duration_seconds,\n        ch.total_syncs_last_7d,\n        ch.failed_syncs_last_7d,\n        ch.success_rate_last_7d,\n        case\n            when ch.total_syncs > 0 then ch.total_syncs / nullif(datediff(day, date_trunc('day', ch.last_sync_at), current_date()), 0)\n            else 0\n        end as avg_syncs_per_day\n    from connector_health ch\n),\n\n-- Calculate active rows by connector\nconnector_active_rows as (\n    select\n        connection_name,\n        sum(total_active_rows) as total_active_rows,\n        sum(free_active_rows) as free_active_rows,\n        sum(paid_active_rows) as paid_active_rows\n    from monthly_active_rows\n    group by 1\n),\n\n-- Generate recommendations\nconnector_recommendations as (\n    select\n        cm.connection_name,\n        cm.connector_name,\n        cm.destination_name,\n        cm.last_sync_at,\n        cm.last_sync_status,\n        cm.total_syncs,\n        cm.successful_syncs,\n        cm.failed_syncs,\n        cm.avg_sync_duration_seconds,\n        cm.avg_syncs_per_day,\n        coalesce(car.total_active_rows, 0) as total_active_rows,\n        coalesce(car.free_active_rows, 0) as free_active_rows,\n        coalesce(car.paid_active_rows, 0) as paid_active_rows,\n        \n        -- Calculate recommendation score (higher = more important to address)\n        case\n            when cm.last_sync_status = 'error' then 100\n            when cm.success_rate_last_7d < 50 then 90\n            when cm.success_rate_last_7d < 80 then 70\n            when cm.avg_sync_duration_seconds > 3600 then 60\n            when cm.avg_syncs_per_day > 24 then 50\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 40\n            else 0\n        end as recommendation_score,\n        \n        -- Determine recommendation priority\n        case\n            when cm.last_sync_status = 'error' then 'Critical'\n            when cm.success_rate_last_7d < 50 then 'High'\n            when cm.success_rate_last_7d < 80 then 'Medium'\n            when cm.avg_sync_duration_seconds > 3600 then 'Medium'\n            when cm.avg_syncs_per_day > 24 then 'Medium'\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 'Low'\n            else 'None'\n        end as recommendation_priority,\n        \n        -- Generate primary recommendation\n        case\n            when cm.last_sync_status = 'error' then 'Fix failing connector'\n            when cm.success_rate_last_7d < 50 then 'Investigate frequent failures'\n            when cm.success_rate_last_7d < 80 then 'Address intermittent failures'\n            when cm.avg_sync_duration_seconds > 3600 then 'Optimize long-running syncs'\n            when cm.avg_syncs_per_day > 24 then 'Reduce sync frequency'\n            when cm.avg_syncs_per_day < 1 and coalesce(car.total_active_rows, 0) = 0 then 'Consider removing unused connector'\n            else 'No action needed'\n        end as primary_recommendation\n        \n    from connector_metrics cm\n    left join connector_active_rows car on cm.connection_name = car.connection_name\n)\n\nselect * from connector_recommendations\norder by recommendation_score desc", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_connector_recommendations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T17:56:42.953659Z", "completed_at": "2025-11-16T17:56:42.955602Z"}, {"name": "execute", "started_at": "2025-11-16T17:56:42.956119Z", "completed_at": "2025-11-16T17:56:44.326618Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.375715970993042, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c06f34-0007-2084-0003-035215477cea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_fivetran_logs.fct_fivetran_executive_dashboard", "compiled": true, "compiled_code": "\n\nwith connector_health as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_connector_health\n),\n\nmonthly_active_rows as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_monthly_active_rows\n),\n\nerror_monitoring as (\n    select * from JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_error_monitoring\n    -- Remove date filter to include all data\n),\n\n-- Calculate connector health metrics\nconnector_health_metrics as (\n    select\n        current_date() as report_date,\n        count(distinct connection_name) as total_connectors,\n        sum(case when last_sync_status = 'success' then 1 else 0 end) as healthy_connectors,\n        sum(case when last_sync_status = 'error' then 1 else 0 end) as failing_connectors,\n        (sum(case when last_sync_status = 'success' then 1 else 0 end) / \n         nullif(count(distinct connection_name), 0)) * 100 as connector_health_percentage\n    from connector_health\n),\n\n-- Calculate active rows metrics\nactive_rows_metrics as (\n    select\n        current_date() as report_date,\n        sum(total_active_rows) as total_active_rows,\n        sum(paid_active_rows) as paid_active_rows,\n        sum(free_active_rows) as free_active_rows\n    from monthly_active_rows\n    -- Use the most recent month if available\n    where month_date = (select max(month_date) from monthly_active_rows)\n),\n\n-- Calculate error metrics\nerror_metrics as (\n    select\n        current_date() as report_date,\n        count(*) as total_errors,\n        count(distinct connection_name) as connectors_with_errors,\n        count(distinct case when is_recurring_error then connection_name else null end) as connectors_with_recurring_errors\n    from error_monitoring\n),\n\n-- Combine all metrics\nexecutive_dashboard as (\n    select\n        chm.report_date,\n        chm.total_connectors,\n        chm.healthy_connectors,\n        chm.failing_connectors,\n        chm.connector_health_percentage,\n        coalesce(arm.total_active_rows, 0) as total_active_rows,\n        coalesce(arm.paid_active_rows, 0) as paid_active_rows,\n        coalesce(arm.free_active_rows, 0) as free_active_rows,\n        coalesce(em.total_errors, 0) as total_errors,\n        coalesce(em.connectors_with_errors, 0) as connectors_with_errors,\n        coalesce(em.connectors_with_recurring_errors, 0) as connectors_with_recurring_errors\n    from connector_health_metrics chm\n    left join active_rows_metrics arm on chm.report_date = arm.report_date\n    left join error_metrics em on chm.report_date = em.report_date\n)\n\nselect * from executive_dashboard", "relation_name": "JASON_CHLETSOS.fivetran_analytics_fct_fivetran_logs.fct_fivetran_executive_dashboard", "batch_results": null}], "elapsed_time": 11.57051396369934, "args": {"which": "run", "introspect": true, "quiet": false, "strict_mode": false, "require_resource_names_without_spaces": false, "require_nested_cumulative_type_params": false, "populate_cache": true, "empty": false, "static_parser": true, "log_level": "info", "defer": false, "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "log_file_max_bytes": 10485760, "macro_debugging": false, "version_check": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "profiles_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs", "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "log_level_file": "debug", "invocation_command": "dbt run", "select": [], "print": true, "partial_parse_file_diff": true, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "project_dir": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs", "cache_selected_only": false, "exclude": [], "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format_file": "debug", "log_path": "/Users/jason.chletsos/Documents/GitHub/dbt-fivetran-logs/logs", "printer_width": 80, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "write_json": true, "state_modified_compare_more_unrendered_values": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true}}